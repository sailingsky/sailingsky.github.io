[{"content":"YOLOç«æƒ…è¯†åˆ« å‰æï¼šæœ‰å¼ Nå¡ğŸ˜Šï¼Œæ›´æ–°é©±åŠ¨è‡³æœ€æ–°ã€‚\nå®‰è£…cuda:\nä¸‹è½½å®‰è£…åŒ…å®‰è£…\nhttps://developer.nvidia.com/cuda-downloads?target_os=Windows\u0026target_arch=x86_64\u0026target_version=11\u0026target_type=exe_local\nå®‰è£…åéªŒè¯å®‰è£…æ˜¯å¦æˆåŠŸ\n1 nvcc -V æä¸ªæ•°æ®é›†ï¼Œå¯ä»¥è‡ªå·±æ‰“æ ‡ææˆ–æ‰¾ä¸ªåˆ«äººæå¥½çš„\nè¿™é‡Œdemoæ‰¾äº†ä¸ªå¼€æºçš„ï¼Œä¸‹è½½åˆ°æœ¬åœ°ï¼š\nhttps://universe.roboflow.com/never-gonna-give-you-up/123-wdvvi/dataset/2\nå®‰è£…yoloä¾èµ–ï¼š\n1 pip install ultralytics ä¸‹è½½æ¨¡å‹æ–‡ä»¶,æˆ‘é€‰çš„yolo26m.pt: https://github.com/ultralytics/assets/releases\nè¿è¡Œ\u0026amp;è°ƒè¯•ï¼š\nè¯•è¿è¡Œï¼š\n1 yolo task=detect mode=train model=model/yolo26m.pt data=dataset/data.yaml epochs=100 imgsz=640 device=0 ç»“æœå‡ºç°é”™è¯¯:\n1 2 3 4 torch.cuda.is_available(): False torch.cuda.device_count(): 0 os.environ[\u0026#39;CUDA_VISIBLE_DEVICES\u0026#39;]: None See https://pytorch.org/get-started/locally/ for up-to-date torch install instructions if no CUDA devices are seen by torch. å¸è½½cpuç‰ˆæœ¬çš„Torch:\n1 pip uninstall torch torchvision torchaudio -y å®‰è£…æ”¯æŒcudaç‰ˆæœ¬ä¾èµ–:\n1 pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121 æ£€æŸ¥CUDA æ˜¯å¦å¯ç”¨:\n1 2 3 import torch print(f\u0026#34;CUDA æ˜¯å¦å¯ç”¨: {torch.cuda.is_available()}\u0026#34;) print(f\u0026#34;æ˜¾å¡åç§°: {torch.cuda.get_device_name(0)}\u0026#34;) å¯ç”¨åï¼Œç»§ç»­è¿è¡Œ4.1çš„æ¨¡å‹è®­ç»ƒï¼Œç„¶åå°±æ¼«é•¿çš„ç­‰å¾…,æˆ‘ç­‰äº†ä¸€å¤©.ï¼ˆæˆ–è€…å¯ä»¥ç”¨ç°æˆçš„åˆ«äººè®­ç»ƒå¥½çš„ï¼šhttps://www.kaggle.com/code/bertnardomariouskono/smoke-fire-detection-yolo/notebookï¼‰\nè®­ç»ƒå®Œæˆåï¼Œä¼šåœ¨å¯¹åº”ç›®å½•ä¸‹ç”Ÿæˆä¸ªbest.ptæ–‡ä»¶ï¼Œæˆ‘ä»¬ç”¨è¿™ä¸ªæ–‡ä»¶è¿›è¡Œç›®æ ‡å›¾åƒæ£€æµ‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 from ultralytics import YOLO model = YOLO(\u0026#39;runs/detect/train3/weights/best.pt\u0026#39;) #å½“æ£€æµ‹å›¾ç‰‡æˆ–è§†é¢‘æµæ—¶ï¼Œå»ºè®®stream=True results = model.predict(source=\u0026#39;images/\u0026#39;,conf=0.3,stream=False) for result in results: fire_count = 0 max_area_ratio = 0 img_area = result.orig_shape[0] * result.orig_shape[1] print(f\u0026#34;\\n\u0026gt;\u0026gt;\u0026gt; æ­£åœ¨åˆ†æ: {result.path}\u0026#34;) print(f\u0026#34;æ£€æµ‹åˆ°çš„æ¡†æ•°é‡: {len(result.boxes)}\u0026#34;) # æ˜¾ç¤ºæ£€æµ‹åçš„å›¾åƒ result.show() for box in result.boxes: cls_id = int(box.cls[0]) label = model.names[cls_id] confidence = box.conf if label == \u0026#39;smoke\u0026#39;: print(f\u0026#34;å‘ç°çƒŸé›¾ï¼\u0026#34;) if label == \u0026#39;fire\u0026#39;: print(f\u0026#34;ã€é«˜é£é™©ï¼šå‘ç°ç«æºã€‘\u0026#34;) YOLOçš„æ›´è¯¦ç»†çš„ç”¨æ³•å¯å‚è€ƒ:https://docs.ultralytics.com/modes/predict/ã€‚å½“ç„¶è¿™ç¯‡æ–‡ç« åªæ˜¯ç®€å•çš„è¯†åˆ«ä¸‹çƒŸé›¾å’Œç«æºï¼Œæ›´æ·±å±‚æ¬¡çš„æ‰©å±•è¿˜å¯ä»¥ç»§ç»­æ·±æŒ–ã€‚\næ•ˆæœå±•ç¤º:\nåŸå›¾ï¼š\nYOLOæ£€æµ‹æ ‡è®°å‡ºçš„å›¾ï¼š\n","date":"2026-01-02T16:13:11+08:00","image":"http://localhost:1313/post/ai/pexels-ahmetyuksek-35881620.jpg","permalink":"http://localhost:1313/p/yolo%E7%81%AB%E6%83%85%E8%AF%86%E5%88%AB/","title":"YOLOç«æƒ…è¯†åˆ«"},{"content":"æœ€è¿‘éœ€è¦è£…ä¸‹mysql8ï¼Œç®€å•åšä¸ªè®°å½•å¤‡ä»½ä¸‹å®‰è£…ï¼Œä»¥ä¾¿ä»¥åã€‚\nä¸‹è½½å‹ç¼©å®‰è£…åŒ…ï¼š å…ˆå»https://dev.mysql.com/downloads/mysql/ ä¸‹è½½å¯¹åº”ç‰ˆæœ¬ï¼Œæˆ‘é€‰æ‹©çš„æ˜¯8.4.4ï¼Œé€‰æ‹©zip\nè§£å‹é…ç½®ï¼š è§£å‹åˆ°ç›®æ ‡ç›®å½•ï¼Œç„¶ååœ¨D:\\dev\\mysql-8.4.4-winx64 æ ¹ç›®å½•ä¸‹æ–°å»ºmysqlçš„é…ç½®æ–‡ä»¶my.ini\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 [mysqld] # è®¾ç½®3309ç«¯å£ port=3309 # è®¾ç½®mysqlçš„å®‰è£…ç›®å½•ï¼Œè®°å¾—åˆ‡æ¢æˆè‡ªå·±çš„è·¯å¾„ basedir=D:\\\\dev\\\\mysql-8.4.4-winx64 # è®¾ç½®mysqlæ•°æ®åº“çš„æ•°æ®çš„å­˜æ”¾ç›®å½• datadir=D:\\\\dev\\\\mysql-8.4.4-winx64\\\\data # å…è®¸æœ€å¤§è¿æ¥æ•° max_connections=200 # å…è®¸è¿æ¥å¤±è´¥çš„æ¬¡æ•°ã€‚è¿™æ˜¯ä¸ºäº†é˜²æ­¢æœ‰äººä»è¯¥ä¸»æœºè¯•å›¾æ”»å‡»æ•°æ®åº“ç³»ç»Ÿ max_connect_errors=10 # æœåŠ¡ç«¯ä½¿ç”¨çš„å­—ç¬¦é›†é»˜è®¤ä¸ºUTF8 character-set-server=utf8 # åˆ›å»ºæ–°è¡¨æ—¶å°†ä½¿ç”¨çš„é»˜è®¤å­˜å‚¨å¼•æ“ default-storage-engine=INNODB # é»˜è®¤ä½¿ç”¨â€œmysql_native_passwordâ€æ’ä»¶è®¤è¯ mysql_native_password=ON [mysql] # è®¾ç½®mysqlå®¢æˆ·ç«¯é»˜è®¤å­—ç¬¦é›† default-character-set=utf8 [client] # è®¾ç½®mysqlå®¢æˆ·ç«¯è¿æ¥æœåŠ¡ç«¯æ—¶é»˜è®¤ä½¿ç”¨çš„ç«¯å£ port=3309 default-character-set=utf8 æ‰“å¼€å‘½ä»¤è¡Œï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 #å®‰è£…mysql8æœåŠ¡ mysqld --install mysql8 #åˆå§‹åŒ–(æ³¨æ„æ­¤åè¾“å‡ºä¸­ä¼šç”Ÿæˆrootçš„é»˜è®¤å¯†ç ) mysqld --initialize --user=root --console #å¯åŠ¨mysql8æœåŠ¡ net start mysql8 #è¿›å…¥mysql mysql -uroot -p #ä¿®æ”¹rootå¯†ç  ALTER USER \u0026#39;root\u0026#39;@\u0026#39;localhost\u0026#39; IDENTIFIED WITH mysql_native_password by \u0026#39;password\u0026#39;; ç»“æŸ~\n","date":"2025-03-31T20:00:24+08:00","image":"http://localhost:1313/p/mysql8%E8%A7%A3%E5%8E%8B%E5%8C%85%E5%AE%89%E8%A3%85/sunset_huba9f2492bfcbea0d162ef0530a98e7b4_4892548_120x120_fill_q75_box_smart1.jpg","permalink":"http://localhost:1313/p/mysql8%E8%A7%A3%E5%8E%8B%E5%8C%85%E5%AE%89%E8%A3%85/","title":"Mysql8è§£å‹åŒ…å®‰è£…"},{"content":"æœ€è¿‘åœ¨é¡¹ç›®ä¸­ç”¨åˆ°sqliteæ•°æ®åº“ä½œä¸ºåº•å±‚æ•°æ®å­˜å‚¨ï¼Œé©±åŠ¨å±‚é¡ºç†æˆç« çš„é‡‡ç”¨äº†sqlite-jdbc+mybatisçš„ç»„åˆï¼Œä½†åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ï¼Œå¶ç°äº†ä¸€ä¸ªéå¸¸å¥‡å¼‚çš„bug.\nå¤ç°ï¼š ç›¸å…³ç»„ä»¶ç‰ˆæœ¬ï¼š\nsqlite-jdbc 3.46.1.0 mybatis-spring-boot-starter 3.0.3 sqlite 3.45.0 åœ¨sqliteæ•°æ®åº“é‡Œåˆ›å»ºtestè¡¨ï¼Œid(bigint) å’Œ name(text) ä¸¤åˆ—ï¼Œæ’å…¥ä¸¤æ¡è®°å½•ï¼š\n1 2 3 id name 22\ttest22 850361281191579648\ttt æ¥ç€å»ºä¸ªç®€å•å·¥ç¨‹ï¼Œdaoå±‚mapper.xmlï¼Œæ•´ä¸ªå®Œæ•´å·¥ç¨‹ç¤ºä¾‹å¯å‚è€ƒï¼šhttps://github.com/sailingsky/sqlite-test.git\n1 2 3 4 5 6 7 8 \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE mapper PUBLIC \u0026#34;-//mybatis.org//DTD Mapper 3.0//EN\u0026#34; \u0026#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd\u0026#34;\u0026gt; \u0026lt;mapper namespace=\u0026#34;com.example.sqlitetest.mapper.TestMapper\u0026#34;\u0026gt; \u0026lt;select id=\u0026#34;queryMaps\u0026#34; resultType=\u0026#34;java.util.Map\u0026#34;\u0026gt; select * from test \u0026lt;/select\u0026gt; \u0026lt;/mapper\u0026gt; æ¥ç€controllerç›´æ¥è°ƒç”¨mapperè¿”å›æŸ¥è¯¢ç»“æœï¼Œæœ¬æ¥æ­£å¸¸çš„ç»“æœåº”è¯¥æ˜¯ï¼š\n1 [{\u0026#34;name\u0026#34;:\u0026#34;test22\u0026#34;,\u0026#34;id\u0026#34;:22},{\u0026#34;name\u0026#34;:\u0026#34; tt\u0026#34;,\u0026#34;id\u0026#34;:850361281191579648}] ä½†å®é™…è·å¾—çš„ç»“æœæ˜¯:\n1 [{\u0026#34;name\u0026#34;:\u0026#34;test22\u0026#34;,\u0026#34;id\u0026#34;:22},{\u0026#34;name\u0026#34;:\u0026#34; tt\u0026#34;,\u0026#34;id\u0026#34;:1881903104}] å¾ˆæ˜æ˜¾ï¼Œç¬¬2æ¡è®°å½•çš„idå€¼è¢«æ”¹å˜äº†ï¼Œbugå°±è¿™æ ·äº§ç”Ÿäº†ã€‚\næ ¹æº è¿½è¸ªæ•´ä¸ªä»£ç æ‰§è¡Œé€»è¾‘ï¼Œå…³é”®é“¾è·¯å¦‚ä¸‹ï¼š\nDefaultResultSetHandler.java#createAutomaticMappings \u0026mdash;\u0026gt;ResultSetWrapper.java#getTypeHandler\n1 2 //è§£æåˆ—å¯¹åº”æ•°æ®ç±»å‹ final Class\u0026lt;?\u0026gt; javaType = resolveClass(classNames.get(index)); è€Œè¿™ä¸ªclassNamesæ˜¯åœ¨ResultSetWrapper è¢«åˆå§‹åŒ–çš„æ—¶å€™èµ‹å€¼ï¼š\n1 2 3 4 5 6 7 8 9 10 11 public ResultSetWrapper(ResultSet rs, Configuration configuration) throws SQLException { this.typeHandlerRegistry = configuration.getTypeHandlerRegistry(); this.resultSet = rs; final ResultSetMetaData metaData = rs.getMetaData(); final int columnCount = metaData.getColumnCount(); for (int i = 1; i \u0026lt;= columnCount; i++) { columnNames.add(configuration.isUseColumnLabel() ? metaData.getColumnLabel(i) : metaData.getColumnName(i)); jdbcTypes.add(JdbcType.forCode(metaData.getColumnType(i))); classNames.add(metaData.getColumnClassName(i)); } } metaData.getColumnClassName(i) è¿™ä¸ªä¼šå»è°ƒç”¨sqlite-jdbcçš„JDBC3ResultSet.java#getColumnClassNameè·å–å¯¹åº”æ•°æ®ç±»å‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 public String getColumnClassName(int col) throws SQLException { switch (safeGetColumnType(markCol(col))) { case SQLITE_INTEGER: long val = getLong(col); if (val \u0026gt; Integer.MAX_VALUE || val \u0026lt; Integer.MIN_VALUE) { return \u0026#34;java.lang.Long\u0026#34;; } else { return \u0026#34;java.lang.Integer\u0026#34;; } case SQLITE_FLOAT: return \u0026#34;java.lang.Double\u0026#34;; case SQLITE_BLOB: case SQLITE_NULL: return \u0026#34;java.lang.Object\u0026#34;; case SQLITE_TEXT: default: return \u0026#34;java.lang.String\u0026#34;; } } å¦‚æœæ˜¯æ•´æ•°å‹ï¼Œå¾ˆæ˜æ˜¾è¿™ä¸ªä¼šæ ¹æ®åˆ—çš„å€¼èŒƒå›´å»è¿”å›å¯¹åº”çš„ç±»å‹ï¼Œæ‰€ä»¥å½“è¿™åˆ—çš„ç¬¬ä¸€è¡Œid(22)çš„å€¼ä¸ºintèŒƒå›´å†…æ—¶ï¼Œå®ƒä¼šè¿”å› \u0026ldquo;java.lang.Integer\u0026rdquo;,è€Œæ¥ä¸‹æ¥å¤„ç†ç±»å‹å¤„ç†å™¨çš„æ—¶å€™ï¼Œå°±ä¼šæ ¹æ®classNamesä¸­çš„ç±»å‹è¿”å›å¯¹åº”åˆ—çš„å¤„ç†å°±æ˜¯\u0026quot;java.lang.Integer\u0026quot;\næ‹¿åˆ°typehandleråï¼Œä¼šå°†å…¶æ”¾å…¥åˆ°autoMappingCacheä¸­ç¼“å­˜èµ·æ¥,åç»­å†ä¹Ÿä¸ä¼šå»è·å–å¯¹åº”åˆ—çš„typeHandleräº†ï¼Œä¹Ÿå°±æ˜¯é’ˆå¯¹idè¿™ä¸€åˆ—ï¼Œå·²ç»é»˜è®¤äº†é‡‡ç”¨\u0026quot;java.lang.Integer\u0026quot;ç±»å‹è¿›è¡Œå¤„ç†ã€‚æ‰€ä»¥æ‰å‡ºç°äº†ç¬¬ä¸€è¡Œå€¼è¿”å›æ­£ç¡®ï¼Œç¬¬äºŒè¡Œå€¼å´é”™è¯¯çš„æƒ…å†µï¼Œå› ä¸ºLongå‹å€¼è¢«å½“åšäº†Integerç±»å‹è¢«å¤„ç†äº†ã€‚\nè§£å†³æ–¹æ¡ˆï¼š é’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘å‘sqlite-jdbcå’Œmybatiséƒ½æäº†ä¸ªissue,https://github.com/xerial/sqlite-jdbc/issues/1177 å’Œ https://github.com/mybatis/mybatis-3/issues/3242ã€‚æœ€åå¾—å‡ºçš„ç»“è®ºï¼šåœ¨sqliteä¸­ï¼Œæœ€å¥½åœ¨mapperä¸­resultTypeä½¿ç”¨å…·ä½“çš„pojoç±»å‹ï¼Œè€Œä¸æ˜¯ä½¿ç”¨java.util.map\n1 2 3 4 5 6 7 8 \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE mapper PUBLIC \u0026#34;-//mybatis.org//DTD Mapper 3.0//EN\u0026#34; \u0026#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd\u0026#34;\u0026gt; \u0026lt;mapper namespace=\u0026#34;com.example.sqlitetest.mapper.TestMapper\u0026#34;\u0026gt; \u0026lt;select id=\u0026#34;queryMaps\u0026#34; resultType=\u0026#34;com.example.sqlitetest.po.TestPO\u0026#34;\u0026gt; select * from test \u0026lt;/select\u0026gt; \u0026lt;/mapper\u0026gt; ","date":"2024-12-29T11:24:38+08:00","image":"http://localhost:1313/p/sqlit-jdbc%E4%B8%8Emybatis%E4%BD%BF%E7%94%A8%E9%80%A0%E6%88%90%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%E9%94%99%E8%AF%AFbug/hari-nandakumar-hh9OkRFj-Pw-unsplash_hu5459c0360c2b0cb7a147d2df0eb350ca_11091288_120x120_fill_q75_box_smart1.jpg","permalink":"http://localhost:1313/p/sqlit-jdbc%E4%B8%8Emybatis%E4%BD%BF%E7%94%A8%E9%80%A0%E6%88%90%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%E9%94%99%E8%AF%AFbug/","title":"sqlit-jdbcä¸mybatisä½¿ç”¨é€ æˆç±»å‹è½¬æ¢é”™è¯¯bug"},{"content":"ThreadPoolExecutorè¿™ä¸ªåº”è¯¥å¾ˆå¤šäººéƒ½ç”¨è¿‡ï¼Œä¸»è¦ç”¨æ¥å¤šçº¿ç¨‹ä»»åŠ¡å¹¶è¡Œæ‰§è¡Œã€‚å½“ç„¶å¦‚æœç”¨ä¸å¥½ï¼Œä¹Ÿä¼šæœ‰å¾ˆå¤šæ„æƒ³ä¸åˆ°çš„å‘ï¼Œæ¯”å¦‚å¸¸è§çš„é˜Ÿåˆ—ç”¨é”™å¯¼è‡´å †æº¢å‡ºã€‚ä»Šå¤©è¯´çš„ä¸æ˜¯è¿™ä¸ªé—®é¢˜ï¼Œè¿™æ˜¯ä¹‹å‰çº¿ä¸Šé‡åˆ°çš„é—®é¢˜ã€‚\nä»£ç  çº¿ç¨‹ä¸šåŠ¡ä»»åŠ¡ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 public class ThreadTask implements Runnable{ @Override public void run() { try { //æ¨¡æ‹Ÿä¸šåŠ¡ä»£ç æ‰§è¡Œæ—¶é—´1s Thread.sleep(1000); logger.info(Thread.currentThread().getName()+\u0026#34; \u0026#34;+System.currentTimeMillis()); } catch (InterruptedException e) { throw new RuntimeException(e); } } } ä¸šåŠ¡ä»£ç ä¸­ä½¿ç”¨ThreadPoolExecutorçº¿ç¨‹æ± ï¼š\n1 2 3 4 5 6 7 8 9 ThreadPoolExecutor threadPoolExecutor = new ThreadPoolExecutor(5,10,3L, TimeUnit.SECONDS,new ArrayBlockingQueue\u0026lt;\u0026gt;(10)); for (int i = 0; i \u0026lt; 30; i++) { ThreadTask threadTask = new ThreadTask(); threadPoolExecutor.submit(threadTask); } threadPoolExecutor.shutdown(); è¿™ä¸ªä»£ç å’‹çœ‹èµ·æ¥ï¼Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆé—®é¢˜å§ã€‚çº¿ç¨‹æ± å¤§å°ï¼Œé˜»å¡é˜Ÿåˆ—ä¹Ÿç”¨çš„æœ‰ç•Œé˜Ÿåˆ—ï¼Œçº¿ç¨‹æ± æœ€åä¹Ÿè¿›è¡Œäº†å…³é—­å¤„ç†ã€‚ç„¶è€Œï¼Œå®é™…æƒ…å†µå´æ˜¯çº¿ç¨‹æ± ä¸ä¼šå…³é—­ï¼Œå› ä¸ºä»£ç æ ¹æœ¬ä¸ä¼šæ‰§è¡Œåˆ°å…³é—­é‚£è¡Œã€‚è¿™æ ·å½“ä»£ç ä¸æ–­æ‰§è¡Œï¼Œåˆ›å»ºçš„çº¿ç¨‹æ± è¶Šæ¥è¶Šå¤šï¼Œçº¿ç¨‹æ± å´æ²¡è¢«å…³é—­ï¼Œæœ€ç»ˆæ‹–å®ç³»ç»Ÿã€‚\nåŸå›  æˆ‘ä»¬ä¸€æ­¥æ­¥æ¥æ¢³ç†ä¸‹ï¼š\næ¥äº†30ä¸ªçº¿ç¨‹ä»»åŠ¡ï¼Œæ‰”åˆ°äº†çº¿ç¨‹æ± é‡Œ æ ¸å¿ƒçº¿ç¨‹æ•°5ï¼Œé‚£ä¹ˆå…ˆåˆ›å»º5ä¸ªçº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼Œè¿˜å‰©25ä¸ªä»»åŠ¡ æ¥ç€æ‰”10ä¸ªä»»åŠ¡åˆ°é˜»å¡é˜Ÿåˆ—ä¸­ï¼Œè¿˜å‰©15ä¸ªä»»åŠ¡ å‘ç°è¿˜æ˜¯ä¸å¤Ÿï¼Œæœ€å¤§çº¿ç¨‹æ•°è¿˜æ²¡è¶…è¿‡10ï¼Œé‚£è¡Œï¼Œå†åˆ›å»º5ä¸ªçº¿ç¨‹è·‘ä»»åŠ¡ï¼Œè¿˜å‰©10ä¸ªä»»åŠ¡ é‚£è¿™å‰©ä¸‹çš„10ä¸ªä»»åŠ¡å°±æ ¹æ®æ‹’ç»ç­–ç•¥å¤„ç†äº†ã€‚ submit æäº¤ä»»åŠ¡åï¼Œä¼šè°ƒç”¨ executeæ–¹æ³•ï¼Œå½“å‘ç°æ— æ³•å†æ·»åŠ workeræ‰§è¡Œä»»åŠ¡æ—¶ï¼Œå°±ä¼šè°ƒç”¨æ‹’ç»ç­–ç•¥çš„rejectæ–¹æ³•ï¼š\né—®é¢˜å‘¢ï¼Œå°±å‡ºåœ¨æœ€åä¸€æ­¥çš„æ‹’ç»ç­–ç•¥ï¼Œå› ä¸ºæºä»£ç ä¸­çº¿ç¨‹æ± åˆå§‹åŒ–æ—¶ï¼Œå¹¶æ²¡æœ‰æŒ‡å®šå…·ä½“çš„æ‹’ç»ç­–ç•¥ï¼Œå°±ä¼šé‡‡ç”¨é»˜è®¤çš„defaultHandler.defaultHandleræ˜¯AbortPolicy.\nçœ‹ä¸‹AbortPolicy é‡Œé¢å¤„ç†æ‹’ç»é€»è¾‘æ˜¯ï¼ŒæŠ›å‡ºäº†ä¸ªRejectExecutionException.\nå¾ˆæ˜æ˜¾ï¼ŒæŠ›å‡ºå¼‚å¸¸åï¼Œåé¢çš„ä»£ç æ‰§è¡Œå°±è¢«ä¸­æ–­äº†ï¼ŒthreadPoolExecutor.shutdown() è¿™ä¸ªä¹Ÿå°±ä¸ä¼šè¢«æ‰§è¡Œäº†ã€‚\nä¼˜åŒ– å°†ä»£ç ç”¨try-catchåŒ…èµ·æ¥ï¼Œåƒè¿™æ ·ï¼š\n1 2 3 4 5 6 7 8 9 10 try { for (int i = 0; i \u0026lt; 30; i++) { ThreadTask threadTask = new ThreadTask(); threadPoolExecutor.submit(threadTask); } }catch (Exception ex){ log.error(ex.getMessage()); }finally{ threadPoolExecutor.shutdown(); } åˆå§‹åŒ–çº¿ç¨‹æ± æ—¶ï¼ŒæŒ‡å®šå…¶ä»–çš„æ‹’ç»ç­–ç•¥\n1 2 ThreadPoolExecutor threadPoolExecutor = new ThreadPoolExecutor(5,10,3L, TimeUnit.SECONDS,new ArrayBlockingQueue\u0026lt;\u0026gt;(10), new ThreadPoolExecutor.DiscardPolicy()); æˆ–è€…è‡ªå®šä¹‰æ‹’ç»ç­–ç•¥\n1 2 3 4 5 6 public class TaskRejectHandler implements RejectedExecutionHandler { @Override public void rejectedExecution(Runnable r, ThreadPoolExecutor executor) { logger.error(\u0026#34;{} had been reject \u0026#34;,r.toString()); } } 4.åŠ å¤§é˜Ÿåˆ—é•¿åº¦ï¼Œæ ¸å¿ƒçº¿ç¨‹æ•°å¤§å°å’Œæœ€å¤§çº¿ç¨‹æ•°å¤§å°ã€‚\n","date":"2024-03-27T11:26:32+08:00","image":"http://localhost:1313/p/threadpoolexecutor%E4%BD%BF%E7%94%A8%E4%B8%8D%E5%BD%93%E7%9A%84bug/neom-LAj90eAXOZA-unsplash_hu5459c0360c2b0cb7a147d2df0eb350ca_4721418_120x120_fill_q75_box_smart1.jpg","permalink":"http://localhost:1313/p/threadpoolexecutor%E4%BD%BF%E7%94%A8%E4%B8%8D%E5%BD%93%E7%9A%84bug/","title":"Threadpoolexecutorä½¿ç”¨ä¸å½“çš„bug"},{"content":"ä¹‹å‰çš„sharding-jdbcæ–‡ç« é‡Œè¯»å†™åˆ†ç¦»æ°´å¹³åˆ†ç‰‡é‡‡ç”¨äº†å–ä½™çš„æ–¹å¼ï¼Œå³æŒ‰ç…§å½“å‰å®ä¾‹æ•°ç®€å•ç²—æš´åŒºåŸŸåˆ†ç‰‡ã€‚è€Œå–ä½™æ¥è¯´ç®€å•æ˜“æ‡‚ï¼Œå¸¦æ¥çš„é—®é¢˜ä¹Ÿæ˜¯æ˜¾è€Œæ˜“è§çš„ï¼Œå°±æ˜¯åœ¨è¿›è¡Œæ‰©å®¹çš„æ—¶å€™ï¼Œä¼šå¯¼è‡´å¾ˆå¤šæ•°æ®çš„è¿ç§»å’ŒæŸ¥è¯¢å¤±æ•ˆã€‚ ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•èƒ½å¤Ÿé¿å…ä»¥ä¸Šçš„é—®é¢˜ï¼Œå…¶æ‰©å®¹ä¹Ÿåªä¼šå½±å“ä¸€å°éƒ¨åˆ†æ•°æ®ï¼Œå…·ä½“çš„ä¸€è‡´æ€§å“ˆå¸Œå¯å‚è€ƒç½‘ä¸Šå¾ˆå¤šçš„åšå®¢ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚\nä¸€è‡´æ€§å“ˆå¸Œç®—æ³•å®šä¹‰ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 package com.example.shardingjdbcdemo.sharding; import lombok.extern.slf4j.Slf4j; import org.apache.shardingsphere.sharding.api.sharding.standard.PreciseShardingValue; import org.apache.shardingsphere.sharding.api.sharding.standard.RangeShardingValue; import org.apache.shardingsphere.sharding.api.sharding.standard.StandardShardingAlgorithm; import java.util.Collection; import java.util.SortedMap; import java.util.TreeMap; /** * @Author: zhangsj * @Date: 2024-03-23 20:00 */ @Slf4j public class ConsistencyShardingAlgorithm implements StandardShardingAlgorithm\u0026lt;Long\u0026gt; { SortedMap\u0026lt;Integer,String\u0026gt; consistentMap = new TreeMap\u0026lt;\u0026gt;(); @Override public String doSharding(Collection\u0026lt;String\u0026gt; availableTargetNames, PreciseShardingValue\u0026lt;Long\u0026gt; shardingValue) { if(consistentMap.isEmpty()){ //æ ¹æ®å®é™…èŠ‚ç‚¹ï¼Œåˆ›å»ºå‡ºå¯¹åº”256ä¸ªè™šæ‹ŸèŠ‚ç‚¹ for(String targetName: availableTargetNames){ for(int j=0;j\u0026lt;256;j++){ String key = targetName+\u0026#34;-\u0026#34;+j; consistentMap.put(getHash(key),targetName); } } } int shardingHash = getHash(shardingValue.getValue()+\u0026#34;\u0026#34;); //å¾—åˆ°å¤§äºè¯¥åˆ†ç‰‡hashå€¼çš„æ‰€æœ‰map SortedMap\u0026lt;Integer,String\u0026gt; subMap = consistentMap.tailMap(shardingHash); if(subMap.isEmpty()){ Integer firstKey = consistentMap.firstKey(); return consistentMap.get(firstKey); }else{ return subMap.get(subMap.firstKey()); } } @Override public Collection\u0026lt;String\u0026gt; doSharding(Collection\u0026lt;String\u0026gt; availableTargetNames, RangeShardingValue\u0026lt;Long\u0026gt; shardingValue) { return availableTargetNames; } @Override public void init() { } @Override public String getType() { return \u0026#34;Consistency\u0026#34;; } //ä½¿ç”¨FNV1_32_HASHç®—æ³•è®¡ç®—æœåŠ¡å™¨çš„Hashå€¼ private static int getHash(String str) { final int p = 16777619; int hash = (int) 2166136261L; for (int i = 0; i \u0026lt; str.length(); i++) { hash = (hash ^ str.charAt(i)) * p; } hash += hash \u0026lt;\u0026lt; 13; hash ^= hash \u0026gt;\u0026gt; 7; hash += hash \u0026lt;\u0026lt; 3; hash ^= hash \u0026gt;\u0026gt; 17; hash += hash \u0026lt;\u0026lt; 5; // å¦‚æœç®—å‡ºæ¥çš„å€¼ä¸ºè´Ÿæ•°åˆ™å–å…¶ç»å¯¹å€¼ if (hash \u0026lt; 0) { hash = Math.abs(hash); } log.info(\u0026#34;key:{},hash:{}\u0026#34;,str,hash); return hash; } } é…ç½®ä¸­è®¾ç½® ç”±äºä¸€è‡´æ€§å“ˆå¸Œä¸€èˆ¬é’ˆå¯¹æ•°æ®åº“æ¥è®¾ç½®ï¼Œæ‰€ä»¥ä¸€è‡´æ€§å“ˆå¸Œåˆ†ç‰‡é…ç½®åªæ”¾åœ¨æ•°æ®åº“ä¸Šã€‚å…³é”®è¯consistency\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 server: port: 8080 spring: shardingsphere: # å†…å­˜æ¨¡å¼ mode: type: Memory datasource: names: master0,master1,slave0,slave1 master0: type: com.zaxxer.hikari.HikariDataSource driver-class-name: com.mysql.jdbc.Driver jdbc-url: jdbc:mysql://192.168.65.131:3306/db_order username: root password: root master1: type: com.zaxxer.hikari.HikariDataSource driver-class-name: com.mysql.jdbc.Driver jdbc-url: jdbc:mysql://192.168.65.131:3308/db_order username: root password: root slave0: type: com.zaxxer.hikari.HikariDataSource driver-class-name: com.mysql.jdbc.Driver jdbc-url: jdbc:mysql://192.168.65.131:3307/db_order username: root password: root slave1: type: com.zaxxer.hikari.HikariDataSource driver-class-name: com.mysql.jdbc.Driver jdbc-url: jdbc:mysql://192.168.65.131:3309/db_order username: root password: root #sqlæ—¥å¿—è¾“å‡º props: sql-show: true rules: # è¯»å†™åˆ†ç¦»é…ç½® readwrite-splitting: data-sources: rwds0: type: Static props: #å†™æ•°æ®æºåç§° write-data-source-name: master0 #è¯»æ•°æ®æºåç§° read-data-source-names: slave0 # è´Ÿè½½å‡è¡¡ç®—æ³•åç§° load-balancer-name: alg_round rwds1: type: Static props: #å†™æ•°æ®æºåç§° write-data-source-name: master1 #è¯»æ•°æ®æºåç§° read-data-source-names: slave1 # è´Ÿè½½å‡è¡¡ç®—æ³•åç§° load-balancer-name: alg_round # è´Ÿè½½å‡è¡¡ç®—æ³•ç±»å‹ load-balancers: alg_round: type: RANDOM # åˆ†ç‰‡é…ç½® sharding: tables: t_order: actual-data-nodes: rwds$-\u0026gt;{0..1}.t_order$-\u0026gt;{0..1} # åˆ†åº“ç­–ç•¥ database-strategy: standard: # åˆ†ç‰‡åˆ—åç§° sharding-column: user_id #åˆ†ç‰‡ç®—æ³•åç§° sharding-algorithm-name: consistency # åˆ†è¡¨ç­–ç•¥ table-strategy: standard: sharding-column: id sharding-algorithm-name: alg_mod #åˆ†å¸ƒå¼åºåˆ—ç­–ç•¥é…ç½® key-generate-strategy: column: id key-generator-name: alg_snowflake sharding-algorithms: #ä¸€è‡´æ€§å“ˆå¸Œ consistency: type: CLASS_BASED props: strategy: standard algorithmClassName: com.example.shardingjdbcdemo.sharding.ConsistencyShardingAlgorithm # åˆ†ç‰‡ç®—æ³•å–ä½™ï¼ŒæŒ‰åˆ†ç‰‡æ•°2å–ä½™ alg_mod: type: mod props: sharding-count: 2 #ä¸»é”®ç”Ÿæˆç­–ç•¥ key-generators: alg_snowflake: type: SNOWFLAKE å½“ç„¶ï¼Œåˆ†ç‰‡ç®—æ³•ä¸æ­¢å¯ä»¥ç”¨æ ‡å‡†ç®—æ³•ï¼Œä¹Ÿå¯é‡‡ç”¨å…¶ä»–çš„åˆ†ç‰‡ç®—æ³•ï¼Œå…·ä½“å¯å‚ç…§å®˜æ–¹æ–‡æ¡£ åˆ†ç‰‡ å’Œ åˆ†ç‰‡ç®—æ³•\n","date":"2024-03-23T21:48:33+08:00","image":"http://localhost:1313/post/java/sharding-jdbc/pexels-google-deepmind-17483874.jpg","permalink":"http://localhost:1313/p/sharding-jdbc%E5%AE%9E%E7%8E%B0%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C%E5%88%86%E7%89%87/","title":"sharding-jdbcå®ç°ä¸€è‡´æ€§å“ˆå¸Œåˆ†ç‰‡"},{"content":"é¢˜ç›®æè¿° ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ cost ï¼Œå…¶ä¸­ cost[i] æ˜¯ä»æ¥¼æ¢¯ç¬¬ i ä¸ªå°é˜¶å‘ä¸Šçˆ¬éœ€è¦æ”¯ä»˜çš„è´¹ç”¨ã€‚ä¸€æ—¦ä½ æ”¯ä»˜æ­¤è´¹ç”¨ï¼Œå³å¯é€‰æ‹©å‘ä¸Šçˆ¬ä¸€ä¸ªæˆ–è€…ä¸¤ä¸ªå°é˜¶ã€‚\nä½ å¯ä»¥é€‰æ‹©ä»ä¸‹æ ‡ä¸º 0 æˆ–ä¸‹æ ‡ä¸º 1 çš„å°é˜¶å¼€å§‹çˆ¬æ¥¼æ¢¯ã€‚\nè¯·ä½ è®¡ç®—å¹¶è¿”å›è¾¾åˆ°æ¥¼æ¢¯é¡¶éƒ¨çš„æœ€ä½èŠ±è´¹ã€‚\nç¤ºä¾‹ 1ï¼š\n1 2 3 4 5 è¾“å…¥ï¼šcost = [10,15,20] è¾“å‡ºï¼š15 è§£é‡Šï¼šä½ å°†ä»ä¸‹æ ‡ä¸º 1 çš„å°é˜¶å¼€å§‹ã€‚ - æ”¯ä»˜ 15 ï¼Œå‘ä¸Šçˆ¬ä¸¤ä¸ªå°é˜¶ï¼Œåˆ°è¾¾æ¥¼æ¢¯é¡¶éƒ¨ã€‚ æ€»èŠ±è´¹ä¸º 15 ã€‚ è§£é¢˜æ€è·¯ å’Œä¹‹å‰leetcode-70 çˆ¬æ¥¼æ¢¯ç±»ä¼¼ï¼Œç¬¬iä¸ªé˜¶æ¢¯çš„æœ€å°ä»£ä»·å…¬å¼ä¸º:d(i)=min(d(i-1),d(i-2))+c(i)\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 public int minCostClimbingStairs(int[] cost) { if(cost==null||cost.length==0) return 0; if(cost.length==1) return cost[0]; //å‰ä¸€ï¼ŒäºŒä¸ªé˜¶æ¢¯çš„ä»£ä»· int first =cost[0],second=cost[1]; for(int i=2;i\u0026lt;cost.length;i++){ //å½“å‰æ¥¼æ¢¯çš„æœ€å°ä»£ä»· int cur = Math.min(first,second)+cost[i]; first=second; second=cur; } return Math.min(first,second); } æ•ˆæœ ","date":"2024-03-11T21:56:55+08:00","image":"http://localhost:1313/post/algorithm/pexels-google-deepmind-18069816.jpg","permalink":"http://localhost:1313/p/leetcode-746-%E6%9C%80%E5%B0%8F%E4%BB%A3%E4%BB%B7%E7%88%AC%E6%A5%BC%E6%A2%AF/","title":"Leetcode-746 æœ€å°ä»£ä»·çˆ¬æ¥¼æ¢¯"},{"content":"é¢˜ç›®æè¿° å‡è®¾ä½ æ­£åœ¨çˆ¬æ¥¼æ¢¯ã€‚éœ€è¦ n é˜¶ä½ æ‰èƒ½åˆ°è¾¾æ¥¼é¡¶ã€‚\næ¯æ¬¡ä½ å¯ä»¥çˆ¬ 1 æˆ– 2 ä¸ªå°é˜¶ã€‚ä½ æœ‰å¤šå°‘ç§ä¸åŒçš„æ–¹æ³•å¯ä»¥çˆ¬åˆ°æ¥¼é¡¶å‘¢ï¼Ÿ\nç¤ºä¾‹ 1ï¼š\n1 2 3 4 5 è¾“å…¥ï¼šn = 2 è¾“å‡ºï¼š2 è§£é‡Šï¼šæœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥çˆ¬åˆ°æ¥¼é¡¶ã€‚ 1. 1 é˜¶ + 1 é˜¶ 2. 2 é˜¶ è§£é¢˜æ€è·¯ å½“n=1, æœ‰1ç§ï¼ˆ1é˜¶ï¼‰æ–¹æ³•ï¼Œå³f(1)=1;\nå½“n=2, æœ‰2ç§ï¼ˆ1 é˜¶ + 1 é˜¶;2é˜¶ï¼‰æ–¹æ³•ï¼Œå³f(2)=2;\nå½“n=3, æœ‰3ç§(1 é˜¶ + 1 é˜¶+1é˜¶;2é˜¶+1é˜¶ï¼›1é˜¶+2é˜¶)æ–¹æ³•ï¼Œå³f(3)=3=f(2)+f(1);\nåˆ©ç”¨æ•°å­¦å½’çº³æ³•ï¼Œå¯å¾—f(n)=f(n-1)+f(n-2),å…¸å‹çš„æ–æ³¢é‚£å¥‘æ•°åˆ—;\nä»£ç  1 2 3 4 5 6 7 8 9 10 public int climbStairs(int n) { int first= 1,second=1; for(int i =1 ;i\u0026lt;n;i++){ int third = first+second; first=second; second=third; } return second; } æ•ˆæœ ","date":"2024-03-11T21:39:57+08:00","image":"http://localhost:1313/post/algorithm/pexels-google-deepmind-18069816.jpg","permalink":"http://localhost:1313/p/leetcode-70-%E7%88%AC%E6%A5%BC%E6%A2%AF/","title":"Leetcode-70 çˆ¬æ¥¼æ¢¯"},{"content":"é¢˜ç›®æè¿° ç»™å®šä¸¤ä¸ªæ•´æ•°æ•°ç»„ preorder å’Œ inorder ï¼Œå…¶ä¸­ preorder æ˜¯äºŒå‰æ ‘çš„å…ˆåºéå†ï¼Œ inorder æ˜¯åŒä¸€æ£µæ ‘çš„ä¸­åºéå†ï¼Œè¯·æ„é€ äºŒå‰æ ‘å¹¶è¿”å›å…¶æ ¹èŠ‚ç‚¹ã€‚\nç¤ºä¾‹ 1:\n1 2 è¾“å…¥: preorder = [3,9,20,15,7], inorder = [9,3,15,20,7] è¾“å‡º: [3,9,20,null,null,15,7] è§£é¢˜æ€è·¯ åˆ©ç”¨è§„åˆ™ï¼Œå‰åºæ•°ç»„è§„åˆ™æ˜¯ï¼šæ ¹-å·¦-å³ ï¼Œä¸­åºæ•°ç»„è§„åˆ™æ˜¯ï¼šå·¦-æ ¹-å³ ä»¥å‰åºæ•°ç»„ä¸ºä¸»ï¼Œç¡®å®šå¥½å·¦å­æ ‘çš„é•¿åº¦ï¼ˆè€Œå·¦å­æ ‘çš„é•¿åº¦ï¼Œå¯ä»¥ä»ä¸­åºæ•°ç»„ä¸­æ ¹å·¦è¾¹æ•°å­—é•¿åº¦è·å¾—ï¼‰ï¼Œæ¥ç€å°±èƒ½åˆ†åˆ«å¯¹å·¦å³å­æ ‘è¿›è¡Œé€’å½’æ„é€ ã€‚ ä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 /** * * @param preorder å‰åºæ•°ç»„ * @param preStart å‰åºæ•°ç»„å¼€å§‹åæ ‡ * @param preEnd å‰åºæ•°ç»„ç»“æŸåæ ‡ * @param inStart ä¸­åºæ•°ç»„å¼€å§‹åæ ‡ * @param inMap * @return */ private TreeNode buildTree(int[] preorder,int preStart,int preEnd,int inStart,Map\u0026lt;Integer,Integer\u0026gt; inMap){ if(preStart\u0026gt;preEnd) return null; TreeNode root = new TreeNode(preorder[preStart]); //æ ¹èŠ‚ç‚¹åœ¨ä¸­åºæ•°ç»„ä¸­çš„ä½ç½®(æ ¹æ®ä¸­åºè§„åˆ™ï¼Œæ ¹èŠ‚ç‚¹å·¦è¾¹çš„éƒ½ä¸ºå·¦å­æ ‘) int rootIdx = inMap.get(preorder[preStart]); //ä¸­åºæ•°ç»„ä¸­å·¦å­æ ‘é•¿åº¦ int leftLen = rootIdx-inStart; //æ„å»ºå·¦å­æ ‘ root.left = buildTree(preorder,preStart+1,preStart+leftLen,inStart,inMap); //å³å­æ ‘ root.right = buildTree(preorder,preStart+leftLen+1,preEnd,rootIdx+1,inMap); return root; } //å‰åºæ•°ç»„è§„åˆ™ï¼šæ ¹-å·¦-å³ï¼›ä¸­åºæ•°ç»„è§„åˆ™ï¼šå·¦-æ ¹-å³ public TreeNode buildTree(int[] preorder, int[] inorder) { //ä¸­åºæ•°ç»„è¾…åŠ©mapï¼Œå­˜æ”¾æ•°ç»„å…ƒç´ å’Œå…¶å¯¹åº”çš„ä½ç½® Map\u0026lt;Integer,Integer\u0026gt; inMap = new HashMap\u0026lt;\u0026gt;(); for (int i=0;i\u0026lt;inorder.length;i++) inMap.put(inorder[i], i); return buildTree(preorder,0, preorder.length, 0,inMap); } æ•ˆæœï¼š ","date":"2024-03-11T21:25:08+08:00","image":"http://localhost:1313/post/algorithm/pexels-google-deepmind-18069816.jpg","permalink":"http://localhost:1313/p/leetcode-105-%E4%BB%8E%E5%89%8D%E5%BA%8F%E4%B8%8E%E4%B8%AD%E5%BA%8F%E9%81%8D%E5%8E%86%E5%BA%8F%E5%88%97%E6%9E%84%E9%80%A0%E4%BA%8C%E5%8F%89%E6%A0%91/","title":"Leetcode-105 ä»å‰åºä¸ä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘"},{"content":"æœ€è¿‘æœ‰ä¸ªéœ€æ±‚ï¼Œæƒ³æŠŠè¯­éŸ³è½¬æˆæ–‡å­—ï¼Œç½‘ä¸Šæœäº†æœï¼Œèƒ½ç”¨çš„å…è´¹çš„æ²¡å¤šå°‘ï¼ŒæŸé£çš„å±…ç„¶è¦æ”¶88å¤§æ´‹ï¼Œå¤ªè´µäº†ï¼Œä¹°ä¸èµ·æ ¹æœ¬ä¹°ä¸èµ·ã€‚åé¢å¯»ç€äº†ä¸ªå…è´¹çš„æ–¹æ³•ï¼Œé‡‡ç”¨whisperè¿›è¡Œè¯­éŸ³æ–‡å­—è½¬æ¢ã€‚\nè–…ä¸ªäº‘ä¸»æœº è¿›å…¥googleäº‘ç›˜(https://drive.google.com/drive/home),æ–°å»º-æ›´å¤š-Google Colaboratory.\næ¥ç€ä¿®æ”¹ä»£ç è¿è¡Œæ—¶ç±»å‹ï¼Œæ›´æ”¹ç›¸åº”é…ç½®ï¼š\nè¿™é‡Œé€‰æ‹©çš„è¿è¡Œæ—¶ï¼šPython3 ,ç¡¬ä»¶åŠ é€Ÿå™¨ T4 GPU\nç„¶åä¿å­˜ä¹‹ï¼Œå³ä¸Šè§’è¿æ¥åˆ°å¯¹åº”çš„ä¸»æœºã€‚\nå®‰è£…whisperåŠé…å¥—ç»„ä»¶ åœ¨ä»£ç æ ä¸­è¾“å…¥ä»¥ä¸‹å†…å®¹ï¼Œå¹¶è¿è¡Œ\n1 2 !pip install git+https://github.com/openai/whisper.git !sudo apt update \u0026amp;\u0026amp; sudo apt install ffmpeg ä¸Šä¼ è¦è½¬æ–‡å­—çš„éŸ³é¢‘æˆ–è§†é¢‘æ–‡ä»¶ï¼š\næ¥ç€æ‰§è¡Œè½¬æ¢å‘½ä»¤ï¼š\n1 !whisper \u0026#34;meeting_01.mp4\u0026#34; --model large-v3 æ ¹æ®æ–‡ä»¶å¤§å°ï¼Œä¼šç­‰å¾…ä¸€æ®µæ—¶é—´ã€‚æœ€ç»ˆæˆåŠŸåä¼šåœ¨æ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆè½¬æ¢å‡ºæ¥çš„ srtæ–‡ä»¶ï¼Œtxtæ–‡ä»¶ï¼Œjsonæ–‡ä»¶ç­‰ï¼Œè¯†åˆ«ç‡ä¹Ÿè¿˜ä¸é”™ã€‚\n","date":"2024-02-22T15:44:27+08:00","image":"http://localhost:1313/post/ai/igor-omilaev-eGGFZ5X2LnA-unsplash.jpg","permalink":"http://localhost:1313/p/whisper%E8%AF%AD%E9%9F%B3%E8%BD%AC%E6%96%87%E5%AD%97/","title":"Whisperè¯­éŸ³è½¬æ–‡å­—"},{"content":"å‰æè£…å¥½mysqlæœåŠ¡ï¼Œè¿˜æœ‰é…å¥—çš„prometheusä»¥åŠgrafanaæœåŠ¡ã€‚\nä¸‹è½½mysqld_exporter å®˜æ–¹ä¸‹è½½åœ°å€ï¼šhttps://github.com/prometheus/mysqld_exporter/releases/download/v0.15.1/mysqld_exporter-0.15.1.windows-amd64.zip\nåœ¨mysqlä¸­æ·»åŠ mysqld_exporterçš„è´¦å·\n1 2 3 4 5 6 7 CREATE USER \u0026#39;exporter\u0026#39;@\u0026#39;localhost\u0026#39; IDENTIFIED BY \u0026#39;exporter\u0026#39;; GRANT PROCESS, REPLICATION CLIENT, SELECT ON *.* TO \u0026#39;exporter\u0026#39;@\u0026#39;localhost\u0026#39;; ALTER USER exporter@localhost IDENTIFIED WITH mysql_native_password BY \u0026#39;exporter\u0026#39;; flush privileges; åœ¨mysqld-exporterç›®å½•ä¸‹æ–°å»ºmy.cnf,åŠ å…¥é…ç½®\n1 2 3 [client] user=exporter password=exporter å¯åŠ¨mysqld_exporter:\n1 mysqld_exporter.exe --config.my-cnf=my.cnf å¦‚å›¾ï¼š\nprometheusä¸­çš„prometheus.ymlå¢åŠ é…ç½®ï¼š\n1 2 3 4 5 6 7 8 # The job name is added as a label `job=\u0026lt;job_name\u0026gt;` to any timeseries scraped from this config. - job_name: \u0026#34;mysql\u0026#34; # metrics_path defaults to \u0026#39;/metrics\u0026#39; # scheme defaults to \u0026#39;http\u0026#39;. static_configs: - targets: [\u0026#34;localhost:9104\u0026#34;] å¯åŠ¨prometheusï¼Œåœ¨é¡µé¢ä¸Šå¯çœ‹åˆ°æ–°åŠ çš„mysql grafanaé…ç½®å¥½prometheusæ•°æ®æºï¼Œå¯¼å…¥dashboard,æˆ‘è¿™ç”¨çš„è¿™ä¸ªdashboard. https://grafana.com/grafana/dashboards/17320-1-mysqld-exporter-dashboard/ æœ€ç»ˆæ•ˆæœ. ","date":"2024-01-15T18:46:18+08:00","image":"http://localhost:1313/p/prometheues%E7%9B%91%E6%8E%A7mysql/Grafana-0_hu9300c52758da7e33076209d5894eb9b9_53190_120x120_fill_box_smart1_3.png","permalink":"http://localhost:1313/p/prometheues%E7%9B%91%E6%8E%A7mysql/","title":"prometheuesç›‘æ§mysql"},{"content":"å®‰è£… ä¸‹è½½æºç åŒ…\u0026amp;ç¼–è¯‘ 1 2 3 4 wget https://download.redis.io/redis-7.2.3.tar.gz tar -zxf redis-7.2.3.tar.gz cd redis-7.2.3 make ä¿®æ”¹é…ç½®redis.conf 1 2 #ç¦ç”¨ä¿æŠ¤æ¨¡å¼ï¼Œç”Ÿäº§å‹¿ç”¨ï¼ protected-mode no ä¸»ä»æ¨¡å¼ ä¸»èŠ‚ç‚¹ï¼š 1 ./src/redis-server /data/redis-master1/redis.conf ä»èŠ‚ç‚¹ï¼š ä¿®æ”¹redis.confä¸­ç«¯å£ç›¸å…³åŠä¸»ä»å¤åˆ¶ä¸»èŠ‚ç‚¹é…ç½® 1 2 3 port 6380 # replicaof ä¸»èŠ‚ç‚¹IP ä¸»èŠ‚ç‚¹ç«¯å£ replicaof 127.0.0.1 6379 replicaof 127.0.0.1 6379 ä¹Ÿå¯ä»¥ç›´æ¥åœ¨ä»èŠ‚ç‚¹å®¢æˆ·ç«¯æ‰§è¡Œå‘½ä»¤ï¼š 1 redis\u0026gt; replicaof 127.0.0.1 6379 å¯åŠ¨ä»èŠ‚ç‚¹åï¼Œå¯åœ¨æ—¥å¿—è¾“å‡ºä¸­çœ‹åˆ°ä¸»ä»åŒæ­¥æˆåŠŸã€‚ éªŒè¯ ä¸»èŠ‚ç‚¹ï¼š\n1 set test this is a key ä»èŠ‚ç‚¹ï¼š\n1 2 3 ./src/redis-cli -p 6380 127.0.0.1:6380\u0026gt; get test å“¨å…µæ¨¡å¼ é…ç½®å“¨å…µèŠ‚ç‚¹ é…ç½®sentinel.confæ–‡ä»¶,å…¶ä»–å“¨å…µä¹Ÿå‚è€ƒè¯¥é…ç½®è¿›è¡Œä¿®æ”¹\n1 2 3 4 5 6 7 8 9 10 11 # sentinelèŠ‚ç‚¹ç«¯å£å· port 26379 # sentinel monitor è¢«ç›‘æ§ä¸»èŠ‚ç‚¹åç§° ä¸»èŠ‚ç‚¹IP ä¸»èŠ‚ç‚¹ç«¯å£ quorum sentinel monitor mymaster 127.0.0.1 6379 2 # sentinel down-after-milliseconds è¢«ç›‘æ§ä¸»èŠ‚ç‚¹åç§° æ¯«ç§’æ•° sentinel down-after-milliseconds mymaster 60000 # sentinel failover-timeout è¢«ç›‘æ§ä¸»èŠ‚ç‚¹åç§° æ¯«ç§’æ•° sentinel failover-timeout mymaster 180000 å¯åŠ¨å“¨å…µèŠ‚ç‚¹ 1 [root@localhost redis-sentinal1]# ./src/redis-sentinel /data/redis-sentinal1/sentinel.conf å…¶ä½™çš„å“¨å…µèŠ‚ç‚¹ä¹Ÿç±»ä¼¼ã€‚\néªŒè¯ å°†master 6379 killæ‰ï¼Œåœ¨å“¨å…µèŠ‚ç‚¹çš„æ—¥å¿—ä¸­å¯æŸ¥çœ‹åˆ°é€‰ä¸¾ä¸»èŠ‚ç‚¹çš„ä¿¡æ¯ï¼š clusteré›†ç¾¤æ¨¡å¼ Redis Cluster åŠŸèƒ½ ï¼šÂ è´Ÿè½½å‡è¡¡ï¼Œæ•…éšœåˆ‡æ¢ï¼Œä¸»ä»å¤åˆ¶Â ã€‚\né…ç½®èŠ‚ç‚¹ï¼š\n1 2 3 4 5 6 # clusterèŠ‚ç‚¹ç«¯å£å·,ä»6700-6705 port 6700 # å¼€å¯é›†ç¾¤æ¨¡å¼ cluster-enabled yes # èŠ‚ç‚¹è¶…æ—¶æ—¶é—´ cluster-node-timeout 15000 åˆ†åˆ«å¯åŠ¨å„ä¸ªèŠ‚ç‚¹ï¼š\n1 ./src/redis-server /data/redis-cluster1/redis.conf åˆ›å»ºcluster\n1 ./src/redis-cli -p 6700 --cluster create 127.0.0.1:6700 127.0.0.1:6701 127.0.0.1:6702 127.0.0.1:6703 127.0.0.1:6704 127.0.0.1:6705 --cluster-replicas 1 åˆ›å»ºæˆåŠŸåä¼šæ˜¾ç¤ºé›†ç¾¤å’ŒèŠ‚ç‚¹ä¿¡æ¯ã€‚ ä¹Ÿå¯é€šè¿‡rediså®¢æˆ·ç«¯æ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼ŒæŸ¥çœ‹é›†ç¾¤ä¿¡æ¯\n1 cluster info é”™è¯¯å¼‚å¸¸è§£å†³ å¦‚æœåœ¨é…ç½®é›†ç¾¤æ—¶ï¼Œå¯åŠ¨å‡ºç° [ERR] Node 127.0.0.1:6700 is not empty. Either the node already knows other nodes (check with CLUSTER NODES) or contains some key in database 0.ã€‚è¿™æ˜¯ç”±äºèŠ‚ç‚¹ä¸­å­˜åœ¨ä»¥å‰æ—§æ•°æ®å¯¼è‡´ã€‚\nè§£å†³æ–¹å¼ï¼š\nåœæ‰æ‰€æœ‰èŠ‚ç‚¹ åˆ é™¤å„èŠ‚ç‚¹çš„nodes.conf å’Œdump.rdbæ–‡ä»¶ é‡æ–°å¯åŠ¨æ‰€æœ‰èŠ‚ç‚¹ é‡æ–°åˆ›å»ºé›†ç¾¤ ","date":"2024-01-15T15:56:26+08:00","image":"http://localhost:1313/p/redis%E9%9B%86%E7%BE%A4%E9%AB%98%E5%8F%AF%E7%94%A8/Logo-redis.svg_hu83de30df5e380d1440b843aa0aed1028_51229_120x120_fill_box_smart1_3.png","permalink":"http://localhost:1313/p/redis%E9%9B%86%E7%BE%A4%E9%AB%98%E5%8F%AF%E7%94%A8/","title":"redisé›†ç¾¤é«˜å¯ç”¨"},{"content":"æ—¥å¸¸ç³»ç»Ÿå¼€å‘ä¸­ï¼Œç»å¸¸æ¶‰åŠåˆ°å¤§æ•°æ®é‡çš„ä¸šåŠ¡ï¼Œå¸¸è§çš„å¦‚å•†åŸç³»ç»Ÿï¼Œè§„æ¨¡ä¸Šå»åï¼Œå•è¡¨ä¼šç»å¸¸ä¸Šåƒä¸‡ç”šè‡³ä¸Šäº¿ã€‚ä»…ä»…é å•è¡¨è‚¯å®šæ˜¯æ— æ³•æ”¯æ’‘ç³»ç»Ÿçš„è§„æ¨¡åŠæ€§èƒ½ï¼Œå› æ­¤è¯ç”Ÿäº†åˆ†åº“åˆ†è¡¨çš„è§£å†³æ–¹æ¡ˆã€‚é¦–å…ˆï¼Œä¸ºäº†ä¿è¯é«˜å¯ç”¨ï¼Œä¼šå¢åŠ ä¸»ä»åº“å¤‡ä»½ï¼›å†è€…ä¸ºäº†é«˜æ€§èƒ½ï¼Œä¼šåˆ©ç”¨ä¸»ä»åº“è¿›è¡Œè¯»å†™åˆ†ç¦»ï¼›ä¸ºäº†é«˜å®¹é‡ï¼Œä¼šè¿›è¡Œåˆ†åº“åˆ†è¡¨ã€‚\næ•´ä½“æ¶æ„å›¾ï¼š master0å’Œmaster1åŒä¸ºå†™åº“ï¼Œç”¨äºæ•°æ®åˆ†ç‰‡ï¼Œå¢åŠ æ•°æ®å®¹é‡ã€‚slave0å’Œslave1ä¸ºä»åº“ï¼Œæä¾›æŸ¥è¯¢èƒ½åŠ›ï¼Œåˆ†æ‹…æŸ¥è¯¢å‹åŠ›ï¼Œæå‡ç³»ç»Ÿæ€§èƒ½ã€‚åŒæ—¶ä½œä¸ºå¤‡ä»½åº“æé«˜å¯é æ€§ã€‚\nmysqlé«˜å¯ç”¨é›†ç¾¤æ­å»º ä¸»mysqlæ­å»º 1.dockeråˆ›å»ºä¸»mysqlæœåŠ¡ 1 2 3 4 5 6 7 docker run -d \\ -p 3306:3306 \\ -v /data/mysql/master0/conf:/etc/mysql/conf.d \\ -v /data/mysql/master0/data:/var/lib/mysql \\ -e MYSQL_ROOT_PASSWORD=root \\ --name mysql-master \\ mysql:8.0.29 2.ä¿®æ”¹ä¸»mysqlé…ç½®æ–‡ä»¶ 1 vim /data/mysql/master0/conf/my.cnf åŠ å…¥ä»¥ä¸‹é…ç½®å†…å®¹:\n1 2 3 4 5 6 7 8 9 10 11 12 [mysqld] # æœåŠ¡å™¨å”¯ä¸€idï¼Œé»˜è®¤å€¼1 server-id=1 # è®¾ç½®æ—¥å¿—æ ¼å¼ï¼Œé»˜è®¤å€¼ROW binlog_format=STATEMENT # äºŒè¿›åˆ¶æ—¥å¿—åï¼Œé»˜è®¤binlog # log-bin=binlog # è®¾ç½®éœ€è¦å¤åˆ¶çš„æ•°æ®åº“ï¼Œé»˜è®¤å¤åˆ¶å…¨éƒ¨æ•°æ®åº“ #binlog-do-db=mytestdb # è®¾ç½®ä¸éœ€è¦å¤åˆ¶çš„æ•°æ®åº“ #binlog-ignore-db=mysql #binlog-ignore-db=infomation_schema é‡å¯mysqlå®¹å™¨ï¼š\n1 docker restart mysql-master0 binlogæ ¼å¼è¯´æ˜ï¼š\nbinlog_format=STATEMENTï¼šæ—¥å¿—è®°å½•çš„æ˜¯ä¸»æœºæ•°æ®åº“çš„å†™æŒ‡ä»¤ï¼Œæ€§èƒ½é«˜ï¼Œä½†æ˜¯now()ä¹‹ç±»çš„å‡½æ•°ä»¥åŠè·å–ç³»ç»Ÿå‚æ•°çš„æ“ä½œä¼šå‡ºç°ä¸»ä»æ•°æ®ä¸åŒæ­¥çš„é—®é¢˜ã€‚\nbinlog_format=ROWï¼ˆé»˜è®¤ï¼‰ï¼šæ—¥å¿—è®°å½•çš„æ˜¯ä¸»æœºæ•°æ®åº“çš„å†™åçš„æ•°æ®ï¼Œæ‰¹é‡æ“ä½œæ—¶æ€§èƒ½è¾ƒå·®ï¼Œè§£å†³now()æˆ–è€… user()æˆ–è€… @@hostname ç­‰æ“ä½œåœ¨ä¸»ä»æœºå™¨ä¸Šä¸ä¸€è‡´çš„é—®é¢˜ã€‚\nbinlog_format=MIXEDï¼šæ˜¯ä»¥ä¸Šä¸¤ç§levelçš„æ··åˆä½¿ç”¨ï¼Œæœ‰å‡½æ•°ç”¨ROWï¼Œæ²¡å‡½æ•°ç”¨STATEMENTï¼Œä½†æ˜¯æ— æ³•è¯†åˆ«ç³»ç»Ÿå˜é‡\n3.è¿›å…¥mysqlä¸»æœåŠ¡å™¨ï¼Œä¿®æ”¹ç™»å½•é™åˆ¶ 1 2 3 4 5 6 #è¿›å…¥å®¹å™¨ï¼šenv LANG=C.UTF-8 é¿å…å®¹å™¨ä¸­æ˜¾ç¤ºä¸­æ–‡ä¹±ç  docker exec -it mysql-master0 env LANG=C.UTF-8 /bin/bash #è¿›å…¥å®¹å™¨å†…çš„mysqlå‘½ä»¤è¡Œ mysql -uroot -p #ä¿®æ”¹é»˜è®¤å¯†ç æ ¡éªŒæ–¹å¼ ALTER USER \u0026#39;root\u0026#39;@\u0026#39;%\u0026#39; IDENTIFIED WITH mysql_native_password BY \u0026#39;root\u0026#39;; 4. åˆ›å»ºæ•°æ®å¤åˆ¶æ‰€ç”¨çš„slaveç”¨æˆ· 1 2 3 4 5 6 7 CREATE USER \u0026#39;slave\u0026#39;@\u0026#39;%\u0026#39;; -- è®¾ç½®å¯†ç  ALTER USER \u0026#39;slave\u0026#39;@\u0026#39;%\u0026#39; IDENTIFIED WITH mysql_native_password BY \u0026#39;root\u0026#39;; -- æˆäºˆå¤åˆ¶æƒé™ GRANT REPLICATION SLAVE ON *.* TO \u0026#39;slave\u0026#39;@\u0026#39;%\u0026#39;; -- åˆ·æ–°æƒé™ FLUSH PRIVILEGES; 5. æŸ¥çœ‹ä¸»mysqlçŠ¶æ€ 1 show master status; ä»æœåŠ¡å™¨æ­å»º 1.dockeråˆ›å»ºå¯åŠ¨ä»æœåŠ¡å™¨ 1 2 3 4 5 6 7 docker run -d \\ -p 3307:3306 \\ -v /data/mysql/slave0/conf:/etc/mysql/conf.d \\ -v /data/mysql/slave0/data:/var/lib/mysql \\ -e MYSQL_ROOT_PASSWORD=root \\ --name mysql-slave1 \\ mysql:8.0.29 2. ä¿®æ”¹ä»æœåŠ¡å™¨é…ç½® 1 vim /data/mysql/slave0/conf/my.cnf ä¿®æ”¹é…ç½®å¦‚ä¸‹ï¼š\n1 2 3 4 5 [mysqld] # æœåŠ¡å™¨å”¯ä¸€idï¼Œæ¯å°æœåŠ¡å™¨çš„idå¿…é¡»ä¸åŒï¼Œå¦‚æœé…ç½®å…¶ä»–ä»æœºï¼Œæ³¨æ„ä¿®æ”¹id server-id=2 # ä¸­ç»§æ—¥å¿—åï¼Œé»˜è®¤xxxxxxxxxxxx-relay-bin #relay-log=relay-bin é‡å¯å®¹å™¨ï¼š\n1 docker restart mysql-slave1 3. ä¿®æ”¹ç™»å½•æ–¹å¼ 1 2 3 4 5 6 #è¿›å…¥å®¹å™¨ï¼š docker exec -it mysql-slave0 env LANG=C.UTF-8 /bin/bash #è¿›å…¥å®¹å™¨å†…çš„mysqlå‘½ä»¤è¡Œ mysql -uroot -p #ä¿®æ”¹é»˜è®¤å¯†ç æ ¡éªŒæ–¹å¼ ALTER USER \u0026#39;root\u0026#39;@\u0026#39;%\u0026#39; IDENTIFIED WITH mysql_native_password BY \u0026#39;root\u0026#39;; 4. é…ç½®ä¸»ä»å…³ç³» 1 2 3 CHANGE MASTER TO MASTER_HOST=\u0026#39;192.168.65.131\u0026#39;, MASTER_USER=\u0026#39;slave\u0026#39;,MASTER_PASSWORD=\u0026#39;root\u0026#39;, MASTER_PORT=3306, MASTER_LOG_FILE=\u0026#39;binlog.000003\u0026#39;,MASTER_LOG_POS=1333; slaveå¯åŠ¨ä¸»ä»åŒæ­¥ 1 2 3 START SLAVE; -- æŸ¥çœ‹çŠ¶æ€ï¼ˆä¸éœ€è¦åˆ†å·ï¼‰ SHOW SLAVE STATUS\\G SpringBooté…ç½® pom.xmlåŠ å…¥sharding-jdbc,mybatis-plus,mysqlé©±åŠ¨ç­‰ä¾èµ–\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;project xmlns=\u0026#34;http://maven.apache.org/POM/4.0.0\u0026#34; xmlns:xsi=\u0026#34;http://www.w3.org/2001/XMLSchema-instance\u0026#34; xsi:schemaLocation=\u0026#34;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\u0026#34;\u0026gt; \u0026lt;modelVersion\u0026gt;4.0.0\u0026lt;/modelVersion\u0026gt; \u0026lt;groupId\u0026gt;com.example\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sharding-jdbc-demo\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;0.0.1-SNAPSHOT\u0026lt;/version\u0026gt; \u0026lt;name\u0026gt;sharding-jdbc-demo\u0026lt;/name\u0026gt; \u0026lt;description\u0026gt;sharding-jdbc-demo\u0026lt;/description\u0026gt; \u0026lt;properties\u0026gt; \u0026lt;java.version\u0026gt;1.8\u0026lt;/java.version\u0026gt; \u0026lt;project.build.sourceEncoding\u0026gt;UTF-8\u0026lt;/project.build.sourceEncoding\u0026gt; \u0026lt;project.reporting.outputEncoding\u0026gt;UTF-8\u0026lt;/project.reporting.outputEncoding\u0026gt; \u0026lt;spring-boot.version\u0026gt;2.3.12.RELEASE\u0026lt;/spring-boot.version\u0026gt; \u0026lt;/properties\u0026gt; \u0026lt;dependencies\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-web\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;mysql\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;mysql-connector-java\u0026lt;/artifactId\u0026gt; \u0026lt;scope\u0026gt;runtime\u0026lt;/scope\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.baomidou\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;mybatis-plus-boot-starter\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.3.1\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.projectlombok\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;lombok\u0026lt;/artifactId\u0026gt; \u0026lt;optional\u0026gt;true\u0026lt;/optional\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.apache.shardingsphere\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;shardingsphere-jdbc-core-spring-boot-starter\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;5.1.1\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-test\u0026lt;/artifactId\u0026gt; \u0026lt;scope\u0026gt;test\u0026lt;/scope\u0026gt; \u0026lt;exclusions\u0026gt; \u0026lt;exclusion\u0026gt; \u0026lt;groupId\u0026gt;org.junit.vintage\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;junit-vintage-engine\u0026lt;/artifactId\u0026gt; \u0026lt;/exclusion\u0026gt; \u0026lt;/exclusions\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;/dependencies\u0026gt; \u0026lt;dependencyManagement\u0026gt; \u0026lt;dependencies\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-dependencies\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;${spring-boot.version}\u0026lt;/version\u0026gt; \u0026lt;type\u0026gt;pom\u0026lt;/type\u0026gt; \u0026lt;scope\u0026gt;import\u0026lt;/scope\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;/dependencies\u0026gt; \u0026lt;/dependencyManagement\u0026gt; \u0026lt;build\u0026gt; \u0026lt;plugins\u0026gt; \u0026lt;plugin\u0026gt; \u0026lt;groupId\u0026gt;org.apache.maven.plugins\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;maven-compiler-plugin\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.8.1\u0026lt;/version\u0026gt; \u0026lt;configuration\u0026gt; \u0026lt;source\u0026gt;1.8\u0026lt;/source\u0026gt; \u0026lt;target\u0026gt;1.8\u0026lt;/target\u0026gt; \u0026lt;encoding\u0026gt;UTF-8\u0026lt;/encoding\u0026gt; \u0026lt;/configuration\u0026gt; \u0026lt;/plugin\u0026gt; \u0026lt;plugin\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-maven-plugin\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;${spring-boot.version}\u0026lt;/version\u0026gt; \u0026lt;configuration\u0026gt; \u0026lt;mainClass\u0026gt;com.example.shardingjdbcdemo.ShardingJdbcDemoApplication\u0026lt;/mainClass\u0026gt; \u0026lt;skip\u0026gt;true\u0026lt;/skip\u0026gt; \u0026lt;/configuration\u0026gt; \u0026lt;executions\u0026gt; \u0026lt;execution\u0026gt; \u0026lt;id\u0026gt;repackage\u0026lt;/id\u0026gt; \u0026lt;goals\u0026gt; \u0026lt;goal\u0026gt;repackage\u0026lt;/goal\u0026gt; \u0026lt;/goals\u0026gt; \u0026lt;/execution\u0026gt; \u0026lt;/executions\u0026gt; \u0026lt;/plugin\u0026gt; \u0026lt;/plugins\u0026gt; \u0026lt;/build\u0026gt; \u0026lt;/project\u0026gt; application.yamlä¸»è¦æ¶‰åŠsharding-jdbcçš„é…ç½®ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 server: port: 8080 spring: shardingsphere: # å†…å­˜æ¨¡å¼ mode: type: Memory datasource: names: master0,master1,slave0,slave1 master0: type: com.zaxxer.hikari.HikariDataSource driver-class-name: com.mysql.jdbc.Driver jdbc-url: jdbc:mysql://192.168.65.131:3306/db_order username: root password: root master1: type: com.zaxxer.hikari.HikariDataSource driver-class-name: com.mysql.jdbc.Driver jdbc-url: jdbc:mysql://192.168.65.131:3308/db_order username: root password: root slave0: type: com.zaxxer.hikari.HikariDataSource driver-class-name: com.mysql.jdbc.Driver jdbc-url: jdbc:mysql://192.168.65.131:3307/db_order username: root password: root slave1: type: com.zaxxer.hikari.HikariDataSource driver-class-name: com.mysql.jdbc.Driver jdbc-url: jdbc:mysql://192.168.65.131:3309/db_order username: root password: root #sqlæ—¥å¿—è¾“å‡º props: sql-show: true rules: # è¯»å†™åˆ†ç¦»é…ç½® readwrite-splitting: data-sources: rwds0: type: Static props: #å†™æ•°æ®æºåç§° write-data-source-name: master0 #è¯»æ•°æ®æºåç§° read-data-source-names: slave0 # è´Ÿè½½å‡è¡¡ç®—æ³•åç§° load-balancer-name: alg_round rwds1: type: Static props: #å†™æ•°æ®æºåç§° write-data-source-name: master1 #è¯»æ•°æ®æºåç§° read-data-source-names: slave1 # è´Ÿè½½å‡è¡¡ç®—æ³•åç§° load-balancer-name: alg_round # è´Ÿè½½å‡è¡¡ç®—æ³•ç±»å‹ load-balancers: alg_round: type: RANDOM # åˆ†ç‰‡é…ç½® sharding: tables: t_order: actual-data-nodes: rwds$-\u0026gt;{0..1}.t_order$-\u0026gt;{0..1} # åˆ†åº“ç­–ç•¥ database-strategy: standard: # åˆ†ç‰‡åˆ—åç§° sharding-column: user_id #åˆ†ç‰‡ç®—æ³•åç§° sharding-algorithm-name: alg_mod # åˆ†è¡¨ç­–ç•¥ table-strategy: standard: sharding-column: id sharding-algorithm-name: alg_mod #åˆ†å¸ƒå¼åºåˆ—ç­–ç•¥é…ç½® key-generate-strategy: column: id key-generator-name: alg_snowflake sharding-algorithms: # åˆ†ç‰‡ç®—æ³•å–ä½™ï¼ŒæŒ‰åˆ†ç‰‡æ•°2å–ä½™ alg_mod: type: mod props: sharding-count: 2 #ä¸»é”®ç”Ÿæˆç­–ç•¥ key-generators: alg_snowflake: type: SNOWFLAKE æµ‹è¯•ä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 package com.example.shardingjdbcdemo; import com.example.shardingjdbcdemo.entity.Order; import com.example.shardingjdbcdemo.mapper.OrderMapper; import org.junit.jupiter.api.Test; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.boot.test.context.SpringBootTest; import java.math.BigDecimal; import java.util.List; /** * @Author: * @Date: 2024-01-09 17:55 */ @SpringBootTest public class ShardingTest { @Autowired OrderMapper orderMapper; @Test public void testInsertOrder(){ for(int i =0;i\u0026lt;5;i++){ Order order = new Order(); order.setOrderNo(\u0026#34;sn20231011\u0026#34;); order.setUserId(Long.valueOf(i+1)); order.setAmount(BigDecimal.valueOf(2.22)); orderMapper.insert(order); } } @Test public void query(){ List\u0026lt;Order\u0026gt; orders = orderMapper.selectList(null); List\u0026lt;Order\u0026gt; orders1 = orderMapper.selectList(null); List\u0026lt;Order\u0026gt; orders2 = orderMapper.selectList(null); List\u0026lt;Order\u0026gt; orders3 = orderMapper.selectList(null); } } å¯ä»æ’å…¥æ•°æ®æŸ¥çœ‹åˆ°å¯¹åº”ä¸»ä»åº“åŠåˆ†ç‰‡æ•°æ®çš„å­˜å‚¨ï¼ŒæŸ¥è¯¢ä¹Ÿå¯æ ¹æ®æ§åˆ¶å°æ‰“å°çš„sqlï¼Œçœ‹åˆ°æ•°æ®çš„æŸ¥è¯¢èµ°çš„ä»åº“äº†ï¼Œåˆ†æ‹…äº†ä¸»åº“çš„å‹åŠ›ã€‚\nå½“ç„¶ï¼Œä½ è¿˜å¯ä»¥æ ¹æ®ä¸Šé¢çš„æ¶æ„ï¼Œæ”¹é€ æˆä¸€ä¸»å¤šä»ï¼Œå®ç°æ°´å¹³åˆ†åº“åˆ†è¡¨ï¼Œå¤šä»åº“è¯»çš„èƒ½åŠ›ã€‚\n","date":"2024-01-09T21:14:46+08:00","image":"http://localhost:1313/post/java/sharding-jdbc/pexels-google-deepmind-17483874.jpg","permalink":"http://localhost:1313/p/sharding-jdbc%E5%AE%9E%E7%8E%B0%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB-%E6%B0%B4%E5%B9%B3%E5%88%86%E7%89%87/","title":"Sharding Jdbcå®ç°è¯»å†™åˆ†ç¦»+æ°´å¹³åˆ†ç‰‡"},{"content":"websocketç›¸å…³é…ç½®ï¼š æ–°å»ºäº†ä¸ªwebsocket-serveræ¨¡å—å¾®æœåŠ¡ã€‚\nå¼•å…¥websocketä¾èµ–ï¼š 1 2 3 4 5 \u0026lt;!-- websocket --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-websocket\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; åŠ å…¥é…ç½®ä»£ç ï¼š\n1 2 3 4 5 6 7 8 @Configuration public class WebSocketConfig { @Bean public ServerEndpointExporter serverEndpointExporter(){ return new ServerEndpointExporter(); } } åŠ å…¥æœåŠ¡æ¥å£é€»è¾‘ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 @ServerEndpoint(\u0026#34;/ws/alert/{userId}\u0026#34;) @Component @Slf4j public class WebSocketServer { /** * concurrentåŒ…çš„çº¿ç¨‹å®‰å…¨Setï¼Œç”¨æ¥å­˜æ”¾æ¯ä¸ªå®¢æˆ·ç«¯å¯¹åº”çš„MyWebSocketå¯¹è±¡ã€‚ */ private static ConcurrentHashMap\u0026lt;String, WebSocketServer\u0026gt; webSocketMap = new ConcurrentHashMap\u0026lt;\u0026gt;(); /** * ä¸æŸä¸ªå®¢æˆ·ç«¯çš„è¿æ¥ä¼šè¯ï¼Œéœ€è¦é€šè¿‡å®ƒæ¥ç»™å®¢æˆ·ç«¯å‘é€æ•°æ® */ private Session session; /** * æ¥æ”¶userId */ private String userId = \u0026#34;\u0026#34;; /** * è¿æ¥å»ºç«‹æˆåŠŸè°ƒç”¨çš„æ–¹æ³• */ @OnOpen public void onOpen(Session session, @PathParam(\u0026#34;userId\u0026#34;) String userId) { this.session = session; this.userId = userId; if (webSocketMap.containsKey(userId)) { webSocketMap.remove(userId); } webSocketMap.put(userId, this); log.info(\u0026#34;ç”¨æˆ·è¿æ¥:{}\u0026#34; , userId ); } /** * è¿æ¥å…³é—­è°ƒç”¨çš„æ–¹æ³• */ @OnClose public void onClose() { if (webSocketMap.containsKey(userId)) { webSocketMap.remove(userId); } log.info(\u0026#34;ç”¨æˆ·é€€å‡º:{}\u0026#34; + userId); } /** * æ”¶åˆ°å®¢æˆ·ç«¯æ¶ˆæ¯åè°ƒç”¨çš„æ–¹æ³• * * @param message å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„æ¶ˆæ¯ */ @OnMessage public void onMessage(String message, Session session) { log.info(\u0026#34;æ”¶åˆ°ç”¨æˆ·æ¶ˆæ¯:{},æŠ¥æ–‡:{}\u0026#34; , userId ,message); } /** * @param session * @param error */ @OnError public void onError(Session session, Throwable error) { log.error(\u0026#34;ç”¨æˆ·é”™è¯¯:\u0026#34; + this.userId + \u0026#34;,åŸå› :\u0026#34; + error.getMessage()); error.printStackTrace(); } /** * å®ç°æœåŠ¡å™¨ä¸»åŠ¨æ¨é€ */ public void sendMessage(String message) { webSocketMap.forEach((key, webSocketServer) -\u0026gt; { try { webSocketServer.session.getBasicRemote().sendText(message); } catch (IOException e) { throw new RuntimeException(e); } }); } } gatewayé…ç½®ï¼š application.ymlåŠ å…¥è·¯ç”±é…ç½®ï¼š\n1 2 3 4 5 6 7 8 9 10 gateway: routes: - id: wsroute # uri: ws://websocket-server uri: ws://localhost:10119 predicates: - Path=/websocket-server/ws/** - Header=Connection,Upgrade filters: - StripPrefix=1 è¶Ÿå‘æ’é›·ï¼š å½“ä½ è§‰å¾—ä¸‡æ— ä¸€å¤±ï¼Œå¯åŠ¨ç›¸å…³æœåŠ¡è¿›è¡Œè°ƒè¯•è¯·æ±‚çš„æ—¶å€™ï¼Œé—®é¢˜å°±æ¥äº†ï¼š\nio.undertow.server.HttpServerExchange cannot be cast to reactor.netty.http.server.HttpServerResponse å¼‚å¸¸ å®Œæ•´å¼‚å¸¸å †æ ˆä¿¡æ¯å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 java.lang.ClassCastException: io.undertow.server.HttpServerExchange cannot be cast to reactor.netty.http.server.HttpServerResponse at org.springframework.web.reactive.socket.server.upgrade.ReactorNettyRequestUpgradeStrategy.upgrade(ReactorNettyRequestUpgradeStrategy.java:163) Suppressed: reactor.core.publisher.FluxOnAssembly$OnAssemblyException: Error has been observed at the following site(s): *__checkpoint â‡¢ org.springframework.cloud.gateway.filter.WeightCalculatorWebFilter [DefaultWebFilterChain] *__checkpoint â‡¢ HTTP GET \u0026#34;/websocket-server/ws/alert/1\u0026#34; [ExceptionHandlingWebHandler] Original Stack Trace: at org.springframework.web.reactive.socket.server.upgrade.ReactorNettyRequestUpgradeStrategy.upgrade(ReactorNettyRequestUpgradeStrategy.java:163) at org.springframework.web.reactive.socket.server.support.HandshakeWebSocketService.lambda$handleRequest$1(HandshakeWebSocketService.java:243) at reactor.core.publisher.FluxFlatMap.trySubscribeScalarMap(FluxFlatMap.java:152) at reactor.core.publisher.MonoFlatMap.subscribeOrReturn(MonoFlatMap.java:53) at reactor.core.publisher.InternalMonoOperator.subscribe(InternalMonoOperator.java:57) at reactor.core.publisher.MonoDefer.subscribe(MonoDefer.java:52) at reactor.core.publisher.MonoDefer.subscribe(MonoDefer.java:52) at reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain.subscribeNext(MonoIgnoreThen.java:236) at reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain.onComplete(MonoIgnoreThen.java:203) at reactor.core.publisher.FluxPeek$PeekSubscriber.onComplete(FluxPeek.java:260) at reactor.core.publisher.FluxMap$MapSubscriber.onComplete(FluxMap.java:142) at reactor.core.publisher.MonoNext$NextSubscriber.onComplete(MonoNext.java:102) at reactor.core.publisher.MonoNext$NextSubscriber.onNext(MonoNext.java:83) at reactor.core.publisher.FluxDematerialize$DematerializeSubscriber.onNext(FluxDematerialize.java:98) at reactor.core.publisher.FluxDematerialize$DematerializeSubscriber.onNext(FluxDematerialize.java:44) at reactor.core.publisher.FluxFlattenIterable$FlattenIterableSubscriber.drainAsync(FluxFlattenIterable.java:421) at reactor.core.publisher.FluxFlattenIterable$FlattenIterableSubscriber.drain(FluxFlattenIterable.java:686) at reactor.core.publisher.FluxFlattenIterable$FlattenIterableSubscriber.onNext(FluxFlattenIterable.java:250) at reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber.onNext(FluxSwitchIfEmpty.java:74) at reactor.core.publisher.Operators$MonoSubscriber.complete(Operators.java:1816) at reactor.core.publisher.MonoFlatMap$FlatMapInner.onNext(MonoFlatMap.java:249) at reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain.complete(MonoIgnoreThen.java:284) at reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain.onNext(MonoIgnoreThen.java:187) at reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain.subscribeNext(MonoIgnoreThen.java:232) at reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain.onComplete(MonoIgnoreThen.java:203) at reactor.core.publisher.MonoIgnoreElements$IgnoreElementsSubscriber.onComplete(MonoIgnoreElements.java:89) at reactor.core.publisher.FluxPeek$PeekSubscriber.onComplete(FluxPeek.java:260) at reactor.core.publisher.FluxDematerialize$DematerializeSubscriber.onComplete(FluxDematerialize.java:121) at reactor.core.publisher.FluxDematerialize$DematerializeSubscriber.onNext(FluxDematerialize.java:91) at reactor.core.publisher.FluxDematerialize$DematerializeSubscriber.onNext(FluxDematerialize.java:44) at reactor.core.publisher.FluxIterable$IterableSubscription.fastPath(FluxIterable.java:340) at reactor.core.publisher.FluxIterable$IterableSubscription.request(FluxIterable.java:227) at reactor.core.publisher.FluxDematerialize$DematerializeSubscriber.request(FluxDematerialize.java:127) at reactor.core.publisher.FluxPeek$PeekSubscriber.request(FluxPeek.java:138) at reactor.core.publisher.MonoIgnoreElements$IgnoreElementsSubscriber.onSubscribe(MonoIgnoreElements.java:72) at reactor.core.publisher.FluxPeek$PeekSubscriber.onSubscribe(FluxPeek.java:171) at reactor.core.publisher.FluxDematerialize$DematerializeSubscriber.onSubscribe(FluxDematerialize.java:77) at reactor.core.publisher.FluxIterable.subscribe(FluxIterable.java:165) at reactor.core.publisher.FluxIterable.subscribe(FluxIterable.java:87) at reactor.core.publisher.Mono.subscribe(Mono.java:4400) at reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain.subscribeNext(MonoIgnoreThen.java:255) at reactor.core.publisher.MonoIgnoreThen.subscribe(MonoIgnoreThen.java:51) at reactor.core.publisher.MonoFlatMap$FlatMapMain.onNext(MonoFlatMap.java:157) at reactor.core.publisher.Operators$MonoSubscriber.complete(Operators.java:1816) at reactor.core.publisher.MonoCollectList$MonoCollectListSubscriber.onComplete(MonoCollectList.java:128) at reactor.core.publisher.DrainUtils.postCompleteDrain(DrainUtils.java:132) at reactor.core.publisher.DrainUtils.postComplete(DrainUtils.java:187) at reactor.core.publisher.FluxMaterialize$MaterializeSubscriber.onComplete(FluxMaterialize.java:141) at reactor.core.publisher.FluxTake$TakeSubscriber.onComplete(FluxTake.java:153) at reactor.core.publisher.FluxTake$TakeSubscriber.onNext(FluxTake.java:133) at reactor.core.publisher.FluxOnErrorResume$ResumeSubscriber.onNext(FluxOnErrorResume.java:79) at reactor.core.publisher.SerializedSubscriber.onNext(SerializedSubscriber.java:99) at reactor.core.publisher.FluxTimeout$TimeoutMainSubscriber.onNext(FluxTimeout.java:180) at reactor.core.publisher.Operators$MonoSubscriber.complete(Operators.java:1816) at reactor.core.publisher.MonoCollectList$MonoCollectListSubscriber.onComplete(MonoCollectList.java:128) at org.springframework.cloud.commons.publisher.FluxFirstNonEmptyEmitting$FirstNonEmptyEmittingSubscriber.onComplete(FluxFirstNonEmptyEmitting.java:325) at reactor.core.publisher.FluxSubscribeOn$SubscribeOnSubscriber.onComplete(FluxSubscribeOn.java:166) at reactor.core.publisher.FluxIterable$IterableSubscription.fastPath(FluxIterable.java:362) at reactor.core.publisher.FluxIterable$IterableSubscription.request(FluxIterable.java:227) at reactor.core.publisher.FluxSubscribeOn$SubscribeOnSubscriber.requestUpstream(FluxSubscribeOn.java:131) at reactor.core.publisher.FluxSubscribeOn$SubscribeOnSubscriber.onSubscribe(FluxSubscribeOn.java:124) at reactor.core.publisher.FluxIterable.subscribe(FluxIterable.java:165) at reactor.core.publisher.FluxIterable.subscribe(FluxIterable.java:87) at reactor.core.publisher.Flux.subscribe(Flux.java:8469) at reactor.core.publisher.FluxFlatMap.trySubscribeScalarMap(FluxFlatMap.java:200) at reactor.core.publisher.MonoFlatMapMany.subscribeOrReturn(MonoFlatMapMany.java:49) at reactor.core.publisher.Flux.subscribe(Flux.java:8455) at reactor.core.publisher.FluxFlatMap.trySubscribeScalarMap(FluxFlatMap.java:200) at reactor.core.publisher.MonoFlatMapMany.subscribeOrReturn(MonoFlatMapMany.java:49) at reactor.core.publisher.FluxFromMonoOperator.subscribe(FluxFromMonoOperator.java:76) at reactor.core.publisher.FluxSubscribeOn$SubscribeOnSubscriber.run(FluxSubscribeOn.java:194) at reactor.core.scheduler.WorkerTask.call(WorkerTask.java:84) at reactor.core.scheduler.WorkerTask.call(WorkerTask.java:37) at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266) at java.util.concurrent.FutureTask.run(FutureTask.java) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:750) å¥½äº†ï¼Œæœ‰å¼‚å¸¸ï¼Œå’±ä»¬ç½‘ä¸Šæ‰¾æ‰¾ç­”æ¡ˆï¼Œå¯åœ¨ç½‘ä¸Šç¿»äº†å¤§åŠå¤©ï¼Œå‘ç°æ²¡å‡ ä¸ªç­”æ¡ˆï¼Œç»å¤§éƒ¨åˆ†è¯´çš„éƒ½æ˜¯å•¥ç§»é™¤tomcatä¾èµ–springcloud gateway+websocketä½¿ç”¨çš„å‘ï¼Œå®é™…ä¸Šå°è¯•äº†å¹¶ä¸è¡Œã€‚åé¢ç¿»åˆ°äº†åšå®¢å›­ä¸Šè¿™å“¥ä»¬çš„æ–‡ç« springCloudGateway-è¸©å‘è®°å½•,åœ¨æ–‡ç« çš„åé¢ï¼Œæœ‰ç›¸åŒçš„å¼‚å¸¸æŠ¥é”™ï¼Œä½†æ˜¯å“¥ä»¬ç›´æ¥æ¢äº†nginxæ¥è½¬å‘äº†ï¼Œä¸èµ°gatewayäº†ã€‚å›§ã€‚\nå‡çº§ç‰ˆæœ¬è¯•è¯•\nçœ‹äº†ä¸‹gatewayç”¨çš„ç‰ˆæœ¬3.1.1ï¼Œå¿ƒæƒ³å¦‚æœå‡çº§ä¸‹å°±èƒ½æˆåŠŸäº†å‘¢ã€‚äºæ˜¯æœ¬åœ°æäº†demoï¼ŒæŠŠspring boot,spring cloudä»¥åŠjdkå’”å’”ä¸€é¡¿å‡çº§ï¼Œæœ€åç”¨äº†\n1 JDKï¼š17ï¼›spring-boot-starter-parentï¼š3.1.5 ï¼›spring-cloud-dependenciesï¼š2022.0.4ï¼›spring-cloud-starter-gatewayï¼š4.0.7 æœŸå¾…ç€ä¼šæœ‰å¥‡è¿¹å‘ç”Ÿã€‚ç„¶è€Œå¹¶æ²¡æœ‰ã€‚æ¥ç€å‡ºç°äº†java.lang.ClassCastException: class org.apache.catalina.connector.ResponseFacade cannot be cast to class reactor.netty.http.server.HttpServerResponse (org.apache.catalina.connector.ResponseFacade and reactor.netty.http.server.HttpServerResponse are in unnamed module of loader 'app') è¿™ä¸ªå¼‚å¸¸ã€‚\nè¿™ä¸ªå¼‚å¸¸å¥½æ‰¾ï¼Œåœ¨githubä¸­æ‰¾åˆ°äº†ç­”æ¡ˆwebsocket connction question ,éœ€è¦åŠ å…¥ä»¥ä¸‹beançš„é…ç½®ï¼š\n1 2 3 4 5 6 7 8 9 10 11 @Bean @Primary public RequestUpgradeStrategy requestUpgradeStrategy() { return new TomcatRequestUpgradeStrategy(); } @Bean @Primary WebSocketClient tomcatWebSocketClient() { return new TomcatWebSocketClient(); } åŠ äº†é‡æ–°å¯åŠ¨ï¼Œå‘ç°å¥½ä½¿äº†ï¼Œèƒ½æˆåŠŸé“¾æ¥è®¿é—®äº†ã€‚\nnacosè´Ÿè½½å‡è¡¡ åœ¨ä»”ç»†çœ‹çœ‹ä¹‹å‰çš„gatewayé…ç½®ï¼Œæ˜¯æ²¡è¿›è¡Œè´Ÿè½½å‡è¡¡é…ç½®çš„ï¼Œç›´æ¥å›ºå®šè½¬ç»™æŸä¸ªwebsocketæœåŠ¡ã€‚ç¯å¢ƒä¸Šæ˜¯éœ€è¦è´Ÿè½½å‡è¡¡é…ç½®çš„ï¼Œå› æ­¤æ”¹ä¸ªé…ç½®è¯•è¯•ã€‚\n1 2 3 4 5 6 7 8 routes: - id: wsroute uri: lb:ws://websocket-server predicates: - Path=/websocket-server/ws/** - Header=Connection,Upgrade filters: - StripPrefix=1 å½“å¯åŠ¨åï¼Œå‘ç°åˆä¸å¥½ä½¿äº†ï¼ŒæŠ¥äº†503å¼‚å¸¸ï¼ŒåŸæ¥æ˜¯å¿˜äº†åŠ å…¥feignç›¸å…³ç»„ä»¶ä¾èµ–ï¼š\n1 2 3 4 5 6 7 8 9 10 \u0026lt;!--feginç»„ä»¶--\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-openfeign\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;!-- Feign Client for loadBalancing --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-loadbalancer\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; ","date":"2023-11-22T16:45:23+08:00","image":"http://localhost:1313/p/spring-cloud-gateway%E8%BD%AC%E5%8F%91websocket%E8%AF%B7%E6%B1%82/chris-rosiak-YSwcI_rmCYo-unsplash_hu3d03a01dcc18bc5be0e67db3d8d209a6_5726551_120x120_fill_q75_box_smart1.jpg","permalink":"http://localhost:1313/p/spring-cloud-gateway%E8%BD%AC%E5%8F%91websocket%E8%AF%B7%E6%B1%82/","title":"Spring cloud gatewayè½¬å‘websocketè¯·æ±‚"},{"content":"ç›®å‰å¾ˆå¤šåº”ç”¨å¼€å‘éƒ¨ç½²éƒ½æ˜¯åŸºäºDockerå®¹å™¨åŒ–ï¼Œä¸ºäº†ç®€åŒ–æœ¬åœ°å¼€å‘æµ‹è¯•ï¼Œå¯ä»¥åœ¨ideaä¸­è¿›è¡Œç›¸å…³é…ç½®ï¼Œå³å¯å®ç°æœ¬åœ°æ‰“åŒ…éƒ¨ç½²é«˜æ•ˆç‡ã€‚\nå‰ç½®æ¡ä»¶ è£…æœ‰Dockerçš„æœåŠ¡å™¨ Idea DockeræœåŠ¡å™¨é…ç½® ä¿®æ”¹/usr/lib/systemd/system/docker.serviceé…ç½®ï¼š 1 vi /usr/lib/systemd/system/docker.service åœ¨é…ç½®é¡¹ExecStartä¸­åŠ å…¥ -H tcp://0.0.0.0:10086ï¼š é…ç½®å®Œæˆåè®°å¾—é‡å¯docker\n1 2 systemctl daemon-reload systemctl restart docker é¡ºä¾¿è®°å¾—ç¡®è®¤é˜²ç«å¢™ï¼Œç›¸å…³ç«¯å£è®°å¾—å¼€æ”¾ï¼š\n1 2 3 4 5 firewall-cmd --zone=public --add-port=10086/tcp --permanent firewall-cmd --reload #æŸ¥çœ‹å¼€æ”¾çš„ç«¯å£ firewall-cmd --list-all ideaé…ç½®: settings-\u0026gt;Build-\u0026gt;Dockeræ–°å¢dockeré…ç½®ï¼Œè¾“å…¥dockeræœåŠ¡æ‰€åœ¨ipåŠä¹‹å‰é…ç½®çš„ç«¯å£ é…ç½®Docker Registry,è¿™æ­¥ä½œç”¨æ˜¯æ–¹ä¾¿æ‹‰å–é•œåƒæ‰“åŒ…æ—¶æ‰€ä¾èµ–çš„å…¶ä»–é•œåƒï¼Œå¦‚ä¸é…ç½®å›½å†…é•œåƒæºï¼Œä¼šå®¹æ˜“å‡ºç°é•œåƒæ‹‰å–å¤±è´¥ï¼š\nå»ºç«‹ç¤ºä¾‹å·¥ç¨‹æµ‹è¯•ï¼š ideaä¸­å»ºä¸ªspringbootå·¥ç¨‹ï¼Œæ­¤æ­¥éª¤ç®€å•ç•¥è¿‡ã€‚\nä¿®æ”¹pom.xmlæ–‡ä»¶ï¼ŒåŠ å…¥plugin,dockerHostå±æ€§é…ç½®ä¹‹å‰å®šä¹‰å¥½çš„:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 \u0026lt;plugin\u0026gt; \u0026lt;groupId\u0026gt;com.spotify\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;docker-maven-plugin\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.2\u0026lt;/version\u0026gt; \u0026lt;executions\u0026gt; \u0026lt;execution\u0026gt; \u0026lt;id\u0026gt;build-image\u0026lt;/id\u0026gt; \u0026lt;phase\u0026gt;package\u0026lt;/phase\u0026gt; \u0026lt;goals\u0026gt; \u0026lt;goal\u0026gt;build\u0026lt;/goal\u0026gt; \u0026lt;/goals\u0026gt; \u0026lt;/execution\u0026gt; \u0026lt;/executions\u0026gt; \u0026lt;configuration\u0026gt; \u0026lt;dockerHost\u0026gt;http://192.168.65.131:2375\u0026lt;/dockerHost\u0026gt; \u0026lt;imageName\u0026gt;zsj/${project.artifactId}\u0026lt;/imageName\u0026gt; \u0026lt;imageTags\u0026gt; \u0026lt;imageTag\u0026gt;${project.version}\u0026lt;/imageTag\u0026gt; \u0026lt;/imageTags\u0026gt; \u0026lt;forceTags\u0026gt;true\u0026lt;/forceTags\u0026gt; \u0026lt;dockerDirectory\u0026gt;${project.basedir}\u0026lt;/dockerDirectory\u0026gt; \u0026lt;resources\u0026gt; \u0026lt;resource\u0026gt; \u0026lt;targetPath\u0026gt;/\u0026lt;/targetPath\u0026gt; \u0026lt;directory\u0026gt;${project.build.directory}\u0026lt;/directory\u0026gt; \u0026lt;include\u0026gt;${project.build.finalName}.jar\u0026lt;/include\u0026gt; \u0026lt;/resource\u0026gt; \u0026lt;/resources\u0026gt; \u0026lt;/configuration\u0026gt; \u0026lt;/plugin\u0026gt; å·¥ç¨‹æ ¹ç›®å½•æ–°å¢Dockerfile:\n1 2 3 4 FROM openjdk:8-jdk-alpine ARG JAR_FILE=target/*.jar COPY ${JAR_FILE} app.jar ENTRYPOINT [\u0026#34;java\u0026#34;,\u0026#34;-jar\u0026#34;,\u0026#34;/app.jar\u0026#34;] è¿è¡Œmavençš„packageä»»åŠ¡ï¼š\næˆåŠŸåå¯åœ¨æ§åˆ¶å°çœ‹åˆ°å¦‚ä¸‹è¾“å‡ºï¼š\nç™»å½•dockeræ‰€åœ¨æœåŠ¡å™¨ï¼ŒæŸ¥çœ‹é•œåƒæ˜¯å¦æ‰“åŒ…ä¸Šä¼ æˆåŠŸï¼š\n","date":"2023-11-14T11:16:14+08:00","image":"http://localhost:1313/p/idea%E6%9E%84%E5%BB%BA%E6%89%93%E5%8C%85%E4%B8%8A%E4%BC%A0docker%E9%95%9C%E5%83%8F/5-maniere-deplacer-conteneur-docker-vers-autre-machine_hu5e9a2feb3483bf40d57feb14e1a23a14_88760_120x120_fill_q75_box_smart1.jpeg","permalink":"http://localhost:1313/p/idea%E6%9E%84%E5%BB%BA%E6%89%93%E5%8C%85%E4%B8%8A%E4%BC%A0docker%E9%95%9C%E5%83%8F/","title":"Ideaæ„å»ºæ‰“åŒ…ä¸Šä¼ Dockeré•œåƒ"},{"content":"é¢˜ç›®å®šä¹‰ï¼š ç»™å®šä¸€ä¸ªä¸å«é‡å¤æ•°å­—çš„æ•°ç»„ nums ï¼Œè¿”å›å…¶ æ‰€æœ‰å¯èƒ½çš„å…¨æ’åˆ— ã€‚ä½ å¯ä»¥ æŒ‰ä»»æ„é¡ºåº è¿”å›ç­”æ¡ˆã€‚\nç¤ºä¾‹ 1ï¼š\nè¾“å…¥ï¼šnums = [1,2,3] è¾“å‡ºï¼š[[1,2,3],[1,3,2],[2,1,3],[2,3,1],[3,1,2],[3,2,1]] ç¤ºä¾‹ 2ï¼š\nè¾“å…¥ï¼šnums = [0,1] è¾“å‡ºï¼š[[0,1],[1,0]] ç¤ºä¾‹ 3ï¼š\nè¾“å…¥ï¼šnums = [1] è¾“å‡ºï¼š[[1]]\næ•´ä½“ç®—æ³•æ€è·¯ï¼š é‡‡ç”¨å›æº¯ç®—æ³•ï¼Œéå†å¾ªç¯æ•°ç»„ï¼Œå½¢æˆè·¯å¾„ï¼Œæ¯ä¸€å±‚ä¸­å¾ªç¯çš„éƒ½æ˜¯æ•°ç»„çš„æ‰€æœ‰å…ƒç´ ï¼Œä¸ºäº†ä¸ä½¿å…ƒç´ é‡å¤ï¼ŒåŠ å…¥é¢å¤–çš„å­˜å‚¨ç©ºé—´å­˜å‚¨åˆ¤æ–­ã€‚\né¢˜è§£ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 public List\u0026lt;List\u0026lt;Integer\u0026gt;\u0026gt; permute(int[] nums) { //å­˜å‚¨æœ€ç»ˆç»“æœ List\u0026lt;List\u0026lt;Integer\u0026gt;\u0026gt; result = new ArrayList\u0026lt;\u0026gt;(); //ä¸´æ—¶å­˜å‚¨æ•°ç»„ä¸­å…ƒç´ æ˜¯å¦å·²è¢«å½“å‰è·¯å¾„ä½¿ç”¨ boolean[] used = new boolean[nums.length]; //è·¯å¾„ LinkedList\u0026lt;Integer\u0026gt; path = new LinkedList\u0026lt;\u0026gt;(); backTrace(path,used,nums,result); return result; } public void backTrace(LinkedList\u0026lt;Integer\u0026gt; path,boolean[] used,int[] nums,List\u0026lt;List\u0026lt;Integer\u0026gt;\u0026gt; result){ //å½“è¿™æ¡è·¯å¾„å…ƒç´ æ•°å’Œæ•°ç»„å¤§å°ä¸€è‡´æ—¶ï¼Œè¯´æ˜è¯¥æ¡è·¯å¾„å·²èµ°å®Œï¼Œå­˜å‚¨ç»“æœå¹¶è¿”å› if (path.size()==nums.length) { result.add(new ArrayList\u0026lt;\u0026gt;(path)); return; } for(int i = 0;i\u0026lt; nums.length;i++){ //å½“æ•°ç»„å…ƒç´ æ ‡è®°è¢«ä½¿ç”¨ï¼Œè·³è¿‡ if(used[i]) continue; //å°†å…ƒç´ åŠ å…¥è·¯å¾„ä¸­ path.add(nums[i]); //æ ‡è®°å…ƒç´ è¢«ä½¿ç”¨ used[i] = true; //å›æº¯å¾€ä¸‹é€‰æ‹©è·¯å¾„ backTrace(path,used,nums,result); //å¾€å›æ’¤é”€é€‰æ‹© used[i] =false; //å»é™¤è·¯å¾„ä¸­å·²é€‰æ‹©çš„å…ƒç´  path.removeLast(); } } ","date":"2023-11-13T17:30:56+08:00","image":"http://localhost:1313/post/algorithm/pexels-google-deepmind-18069816.jpg","permalink":"http://localhost:1313/p/%E5%85%A8%E6%8E%92%E5%88%97/","title":"å…¨æ’åˆ—"},{"content":"èµ·å›  æœ€è¿‘å› å·¥ä½œéœ€è¦ï¼Œéœ€è¦è°ƒç”¨grpcæœåŠ¡çš„ä¸€ä¸ªæ¥å£ï¼Œä»¥å‰ä¹Ÿæ²¡æ¥è§¦è¿‡ï¼Œæ¥å£æä¾›æ–¹å‘¢å°±æ‰”äº†ä¸ªprotoæ–‡ä»¶è¿‡æ¥ï¼Œæ²¡æ³•ï¼Œåœ¨ç½‘ä¸Šåˆ°å¤„ç¿»ç¿»æ‰¾æ‰¾ï¼Œè¯´çš„éƒ½æ¯”è¾ƒæ‚ä¹±ï¼Œç¼ºå°‘éƒ¨åˆ†ç»†èŠ‚ï¼Œå°±ç®€å•å†™ä¸ªæ–‡ç« è®°å½•ä¸‹å§ã€‚\nå…·ä½“ç»†èŠ‚ å¼•å…¥protoæ–‡ä»¶ åœ¨å·¥ç¨‹\\src\\mainç›®å½•ä¸‹æ–°å»ºprotoç›®å½•ï¼Œå°†æœåŠ¡æä¾›æ–¹æä¾›çš„protoæ–‡ä»¶æ”¾å…¥è¯¥ç›®å½•ã€‚\npom.xmlæ–‡ä»¶å¼•å…¥ä¾èµ–åŠmavenæ’ä»¶ï¼š\n1 2 3 4 5 6 \u0026lt;!-- grpc client --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;net.devh\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;grpc-client-spring-boot-starter\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.14.0.RELEASE\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; mavenæ’ä»¶ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 \u0026lt;extensions\u0026gt; \u0026lt;!-- os-maven-plugin æ’ä»¶ï¼Œä» OS ç³»ç»Ÿä¸­è·å–å‚æ•° --\u0026gt; \u0026lt;extension\u0026gt; \u0026lt;groupId\u0026gt;kr.motd.maven\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;os-maven-plugin\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.5.0.Final\u0026lt;/version\u0026gt; \u0026lt;/extension\u0026gt; \u0026lt;/extensions\u0026gt; \u0026lt;plugins\u0026gt; \u0026lt;plugin\u0026gt; \u0026lt;!-- protobuf-maven-plugin æ’ä»¶ï¼Œé€šè¿‡ protobuf æ–‡ä»¶ï¼Œç”Ÿæˆ Service å’Œ Message ç±» --\u0026gt; \u0026lt;plugin\u0026gt; \u0026lt;groupId\u0026gt;org.xolstice.maven.plugins\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;protobuf-maven-plugin\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;0.5.1\u0026lt;/version\u0026gt; \u0026lt;configuration\u0026gt; \u0026lt;pluginId\u0026gt;grpc-java\u0026lt;/pluginId\u0026gt; \u0026lt;protocArtifact\u0026gt;com.google.protobuf:protoc:3.5.1:exe:${os.detected.classifier} \u0026lt;/protocArtifact\u0026gt; \u0026lt;pluginArtifact\u0026gt;io.grpc:protoc-gen-grpc-java:1.51.0:exe:${os.detected.classifier} \u0026lt;/pluginArtifact\u0026gt; \u0026lt;/configuration\u0026gt; \u0026lt;executions\u0026gt; \u0026lt;execution\u0026gt; \u0026lt;goals\u0026gt; \u0026lt;goal\u0026gt;compile\u0026lt;/goal\u0026gt; \u0026lt;goal\u0026gt;compile-custom\u0026lt;/goal\u0026gt; \u0026lt;/goals\u0026gt; \u0026lt;/execution\u0026gt; \u0026lt;/executions\u0026gt; application.yamlä¸­æ·»åŠ grpcé…ç½®ï¼š\n1 2 3 4 5 6 7 grpc: client: grpc-client: address: \u0026#39;static://${grpcæœåŠ¡åœ°å€}\u0026#39; enableKeepAlive: true keepAliveWithoutCalls: true negotiationType: plaintext è·‘mvn compileä»»åŠ¡ï¼Œå°†protobufæ–‡ä»¶ç”Ÿæˆå¯¹åº”çš„Javaä»£ç \nåœ¨ä¸šåŠ¡ä»£ç ä¸­è°ƒç”¨grpcæœåŠ¡ï¼š\n1 2 3 4 5 6 7 8 @GrpcClient(\u0026#34;grpc-client\u0026#34;) private xxGrpc.xxBlockingStub xxStub; public boolean sync(){ Request.SyncRequest request = Request.SyncRequest.newBuilder().setType(\u0026#34;sync\u0026#34;).build(); Response.CommonResponse commonResponse = xxStub.syncRulesHandler(request); return commonResponse.getCode()==0; } éªŒè¯grpcæœåŠ¡ï¼š\nå¦‚æœåªæ˜¯æƒ³å•çº¯éªŒè¯ä¸‹grpcæœåŠ¡æ˜¯å¦æ­£å¸¸ï¼Œå¯ä»¥ç”¨postmanè¿›è¡Œæ“ä½œã€‚\né€‰æ‹©è¯·æ±‚ç±»å‹grpcï¼š\nå¯¼å…¥protobufæ–‡ä»¶ï¼š\næ¥ç€å°±å¯ä»¥è¾“å…¥grpcæœåŠ¡åœ°å€åŠå¯¹åº”å‚æ•°è¿›è¡Œæµ‹è¯•äº†ã€‚\n","date":"2023-11-09T11:06:11+08:00","image":"http://localhost:1313/p/spring-boot-%E8%B0%83%E7%94%A8grpc/steve-busch-b_nBSjoGtrU-unsplash_hu3d03a01dcc18bc5be0e67db3d8d209a6_1755468_120x120_fill_q75_box_smart1.jpg","permalink":"http://localhost:1313/p/spring-boot-%E8%B0%83%E7%94%A8grpc/","title":"Spring boot è°ƒç”¨Grpc"},{"content":"æ–æ³¢é‚£å¥‘æ•°åˆ—å®šä¹‰ï¼š å¼•ç”¨è‡ªç»´åŸºç™¾ç§‘ï¼š\næ–æ³¢é‚£å¥‘æ•°ï¼ˆæ„å¤§åˆ©è¯­ï¼šSuccessione di Fibonacciï¼‰ï¼Œåˆè¯‘ä¸ºè²æ³¢æ‹¿å¥‘æ•°ã€è²æ³¢é‚£è¥¿æ•°ã€æ–æ°æ•°ã€é»„é‡‘åˆ†å‰²æ•°ã€‚æ‰€å½¢æˆçš„æ•°åˆ—ç§°ä¸ºæ–æ³¢é‚£å¥‘æ•°åˆ—ï¼ˆæ„å¤§åˆ©è¯­ï¼šSuccessione di Fibonacciï¼‰ï¼Œåˆè¯‘ä¸ºè²æ³¢æ‹¿å¥‘æ•°åˆ—ã€è²æ³¢é‚£è¥¿æ•°åˆ—ã€æ–æ°æ•°åˆ—ã€é»„é‡‘åˆ†å‰²æ•°åˆ—ã€‚è¿™ä¸ªæ•°åˆ—æ˜¯ç”±æ„å¤§åˆ©æ•°å­¦å®¶æ–æ³¢é‚£å¥‘åœ¨ä»–çš„ã€Šç®—ç›˜ä¹¦ã€‹ä¸­æå‡ºã€‚\nåœ¨æ•°å­¦ä¸Šï¼Œæ–æ³¢é‚£å¥‘æ•°æ˜¯ä»¥é€’å½’çš„æ–¹æ³•æ¥å®šä¹‰ï¼š\nï¼ˆ) ç”¨æ–‡å­—æ¥è¯´ï¼Œå°±æ˜¯æ–æ³¢é‚£å¥‘æ•°åˆ—ç”±0å’Œ1å¼€å§‹ï¼Œä¹‹åçš„æ–æ³¢é‚£å¥‘æ•°å°±æ˜¯ç”±ä¹‹å‰çš„ä¸¤æ•°ç›¸åŠ è€Œå¾—å‡ºã€‚\né€’å½’è§£æ³•1ï¼š æ ¹æ®å…¶æ•°å­¦å®šä¹‰ï¼Œé‡‡ç”¨é€’å½’æ–¹å¼ï¼Œç›´è¯‘æˆä»£ç ï¼š\n1 2 3 4 static int fib1(int n){ if(n==0||n==1) return n; return fib1(n-1)+fib1(n-2); } æ­¤ç§æ–¹å¼ç®€å•æ˜äº†ï¼Œä½†è¿è¡Œèµ·æ¥ä¼šå‘ç°ï¼Œéšç€nçš„å¢å¤§ï¼Œå…¶è€—æ—¶ä¹Ÿéšç€å¢å¤§å˜æ…¢ã€‚å…¶ä¸­åŸå› åœ¨äºä¼šé‡å¤è®¡ç®—ï¼Œå¦‚n=40æ—¶ï¼Œç¬¬ä¸€æ¬¡é€’å½’æ—¶è®¡ç®—f(39)å’Œf(38)ï¼Œç¬¬äºŒæ¬¡é€’å½’æ—¶è®¡ç®—f(38),f(37)ä»¥åŠf(37)å’Œf(36)ã€‚ä¸ºäº†åŠ å¿«æ•ˆç‡ï¼Œæˆ‘ä»¬å¯ä»¥åŠ å…¥ä¸ªä¸´æ—¶å­˜å‚¨ç©ºé—´ï¼Œå°†è®¡ç®—è¿‡çš„ç»“æœå­˜æ”¾ä¸æ­¤ã€‚\né€’å½’ä¸´æ—¶å­˜å‚¨ï¼š è¿ç”¨æ•°ç»„å­˜æ”¾å·²è®¡ç®—è¿‡çš„ç»“æœï¼Œæ•°ç»„é•¿åº¦ä¸ºn+1;\n1 2 3 4 5 6 7 static int fibWithArrayTemp(int n,int[] temp){ if(n==0||n==1) return n; //å¦‚æœè¯¥ä½ç½®é0ï¼Œè¯´æ˜å·²ç»å­˜åœ¨è®¡ç®—ç»“æœ if(temp[n]!=0) return temp[n]; temp[n] = fibWithArrayTemp(n-1,temp)+fibWithArrayTemp(n-2,temp); return temp[n]; } åŠ¨æ€è§„åˆ’è§£æ³•ï¼š ä»¥ä¸Šè§£æ³•éƒ½æ˜¯åˆ©ç”¨é€’å½’ï¼Œä»ä¸Šå¾€ä¸‹è¿›è¡Œï¼Œé‡‡ç”¨åŠ¨æ€è§„åˆ’ï¼Œç”±ä¸‹å¾€ä¸Šè¿›è¡Œè®¡ç®—ã€‚è¾…åŠ©æ•°ç»„dptableç”¨äºå­˜å‚¨è®¡ç®—è¿‡ç¨‹ä¸­äº§ç”Ÿçš„ç»“æœã€‚\n1 2 3 4 5 6 7 8 9 static int fibWithDP(int n){ if(n==0) return 0; int[] dptable = new int[n+1]; dptable[0]=0;dptable[1]=1; for(int i=2;i\u0026lt;=n;i++){ dptable[i] = dptable[i-1]+dptable[i-2]; } return dptable[n]; } åŠ¨æ€è§„åˆ’è§£æ³•-ä¼˜åŒ–ï¼š ä¸Šé¢çš„éƒ½æ˜¯é€šè¿‡åˆ›å»ºn+1ä¸ªå…ƒç´ æ•°ç»„ï¼Œä½œä¸ºä¸´æ—¶ç»“æœå­˜å‚¨ã€‚ç©ºé—´å¤æ‚åº¦ä¸ºO(N),é‚£è¿˜æœ‰æ²¡æœ‰å¯èƒ½ä¼˜åŒ–ä¸€ä¸‹ã€‚å½“ç„¶æ˜¯å¯ä»¥çš„ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾å‡ºè§„å¾‹ï¼Œå‘ç°æœ‰ç”¨çš„éƒ½æ˜¯å‰ä¸¤ä¸ªç»“æœå…ƒç´ ï¼Œå¯ä»¥åªç”¨ä¸¤ä¸ªå˜é‡å­˜å‚¨å³å¯ï¼Œè¿™æ ·èƒ½å°†ç©ºé—´å¤æ‚åº¦é™ä¸ºO(1)ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 static int fibWithDPOpt(int n ){ if(n==0) return 0; //å‰åä¸¤ä¸ªå…ƒç´  int pre= 0,post = 1 ; int result = 0; for(int i=2;i\u0026lt;=n;i++){ result = pre+post; //æ»šåŠ¨æ›´æ–°å‰åä¸¤ä¸ªå…ƒç´ ç»“æœ pre = post; post = result; } return result; } ","date":"2023-09-25T10:52:14+08:00","image":"http://localhost:1313/post/algorithm/pexels-google-deepmind-18069816.jpg","permalink":"http://localhost:1313/p/%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E6%95%B0%E5%88%97%E8%A7%A3%E6%B3%95/","title":"æ–æ³¢é‚£å¥‘æ•°åˆ—è§£æ³•"},{"content":"ä¸‹è½½å®‰è£…hugo å»githubä¸Šä¸‹è½½å¯¹åº”ç³»ç»Ÿçš„å®‰è£…åŒ…ï¼šhugoå®‰è£…åŒ…ã€‚ç”±äºæˆ‘æ˜¯windowsç³»ç»Ÿï¼Œé‚£å°±ä¸‹è½½windowsç‰ˆæœ¬ã€‚ ä¸‹è½½å®Œæˆåï¼Œè§£å‹å°†å®‰è£…æ–‡ä»¶æ”¾è‡³åˆ°æŸä¸ªç›®å½•ã€‚ä¿®æ”¹ç¯å¢ƒå˜é‡path,æ·»åŠ åˆšæ‰hugoæ–‡ä»¶æ‰€åœ¨è·¯å¾„ã€‚ å‘½ä»¤è¡ŒéªŒè¯æ˜¯å¦æœ¬åœ°å®‰è£…æˆåŠŸï¼š åˆ›å»ºGithubä»“åº“ åˆ›å»ºåšå®¢æºæ–‡ä»¶å†…å®¹ä»“åº“ï¼š åå­—éšæ„å– åˆ›å»ºGitHub Pagesä»“åº“ï¼š ä»“åº“åç§°å¿…é¡»ä½¿ç”¨\u0026lt;username.github.io\u0026gt;çš„æ ¼å¼ï¼Œusernameä¸ºGitHubçš„ç”¨æˆ·å: ~~### å°†åšå®¢æºæ–‡ä»¶å†…å®¹ä»“åº“æ‹‰åˆ°æœ¬åœ°ï¼š\n1 git clone https://github.com/username/blog.git ~~### ç”¨hugoåˆ›å»ºç½‘ç«™ï¼š\nè¿›å…¥åˆšä¸‹çš„æœ¬åœ°ä»“åº“æ–‡ä»¶å¤¹ï¼Œå¦‚blog ä½¿ç”¨å‘½ä»¤hugo new site ç½‘ç«™åç§°åˆ›å»ºç½‘ç«™ã€‚ 1 2 cd blog hugo new site bytecode-blog ~~### å®‰è£…å’Œé…ç½®hugoä¸»é¢˜\nè¿›å…¥åˆ°ä¹‹å‰çš„myblogç›®å½•ï¼Œæ ¹æ®é€‰æ‹©çš„hugoä¸»é¢˜å®‰è£…æ–‡ä»¶ï¼Œæˆ‘è¿™é‡Œé€‰æ‹©çš„æ˜¯stackä¸»é¢˜ï¼š\n1 git submodule add https://github.com/CaiJimmy/hugo-theme-stack/ themes/hugo-theme-stack ~~### é…ç½®ä¸»é¢˜\nå°†themes\\hugo-theme-stack\\exampleSiteé‡Œé¢çš„contentæ–‡ä»¶ä»¥åŠconfig.yamlæ‹·è´è¦†ç›–åˆ°æ ¹ç›®å½•ä¸‹\næ›´ç®€å•çš„ä½œæ³•ï¼Œå‰é¢åˆ é™¤çº¿çš„æ­¥éª¤çš†å¯ä¸ç”¨ï¼ å¦‚æœç¡®å®šä½¿ç”¨stackä¸»é¢˜ï¼Œç›´æ¥å»GitHubä¸‹è½½stack-starterå·¥ç¨‹ã€‚ ä¿®æ”¹config\\_defaultç›®å½•ä¸‹çš„config.tomlæ–‡ä»¶ï¼Œå°†baseurlä¿®æ”¹ä¸ºï¼šhttps://\u0026lt;github-username\u0026gt;.github.io/ è¿è¡Œhugo serverå‘½ä»¤ï¼Œå³å¯åœ¨æœ¬åœ°çœ‹åˆ°æ•ˆæœã€‚ è¿è¡Œhugoå‘½ä»¤ï¼Œå°†ç”Ÿæˆå¯¹åº”çš„é™æ€æ–‡ä»¶ã€‚åœ¨publicæ–‡ä»¶å¤¹ä¸‹ã€‚ è¿›å…¥åˆ°publicæ–‡ä»¶å¤¹ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤,å°†é™æ€æ–‡ä»¶ä¸Šä¼ åˆ°Githubï¼š 1 2 3 4 5 6 7 8 9 10 11 git init -b main git remote add origin git@github.com:\u0026lt;github-username\u0026gt;/\u0026lt;github-username\u0026gt;.github.io.git git pull --rebase origin main git add . git commit -m \u0026#39;message\u0026#39; git push origin main æŸ¥çœ‹æ•ˆæœï¼š æ¥ç€ä½ å°±å¯ä»¥è®¿é—®https://\u0026lt;github-username\u0026gt;.github.ioæŸ¥çœ‹æ•ˆæœäº†ï¼š ","date":"2023-09-17T18:07:30+08:00","image":"http://localhost:1313/p/build-blog/cover_hu3d03a01dcc18bc5be0e67db3d8d209a6_790554_120x120_fill_q75_box_smart1.jpg","permalink":"http://localhost:1313/p/build-blog/","title":"Build Blog"},{"content":"This article offers a sample of basic Markdown syntax that can be used in Hugo content files, also it shows whether basic HTML elements are decorated with CSS in a Hugo theme.\nHeadings The following HTML \u0026lt;h1\u0026gt;â€”\u0026lt;h6\u0026gt; elements represent six levels of section headings. \u0026lt;h1\u0026gt; is the highest section level while \u0026lt;h6\u0026gt; is the lowest.\nH1 H2 H3 H4 H5 H6 Paragraph Xerum, quo qui aut unt expliquam qui dolut labo. Aque venitatiusda cum, voluptionse latur sitiae dolessi aut parist aut dollo enim qui voluptate ma dolestendit peritin re plis aut quas inctum laceat est volestemque commosa as cus endigna tectur, offic to cor sequas etum rerum idem sintibus eiur? Quianimin porecus evelectur, cum que nis nust voloribus ratem aut omnimi, sitatur? Quiatem. Nam, omnis sum am facea corem alique molestrunt et eos evelece arcillit ut aut eos eos nus, sin conecerem erum fuga. Ri oditatquam, ad quibus unda veliamenimin cusam et facea ipsamus es exerum sitate dolores editium rerore eost, temped molorro ratiae volorro te reribus dolorer sperchicium faceata tiustia prat.\nItatur? Quiatae cullecum rem ent aut odis in re eossequodi nonsequ idebis ne sapicia is sinveli squiatum, core et que aut hariosam ex eat.\nBlockquotes The blockquote element represents content that is quoted from another source, optionally with a citation which must be within a footer or cite element, and optionally with in-line changes such as annotations and abbreviations.\nBlockquote without attribution Tiam, ad mint andaepu dandae nostion secatur sequo quae. Note that you can use Markdown syntax within a blockquote.\nBlockquote with attribution Don\u0026rsquo;t communicate by sharing memory, share memory by communicating.\nâ€” Rob Pike1\nTables Tables aren\u0026rsquo;t part of the core Markdown spec, but Hugo supports supports them out-of-the-box.\nName Age Bob 27 Alice 23 Inline Markdown within tables Italics Bold Code italics bold code A B C D E F Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus ultricies, sapien non euismod aliquam, dui ligula tincidunt odio, at accumsan nulla sapien eget ex. Proin eleifend dictum ipsum, non euismod ipsum pulvinar et. Vivamus sollicitudin, quam in pulvinar aliquam, metus elit pretium purus Proin sit amet velit nec enim imperdiet vehicula. Ut bibendum vestibulum quam, eu egestas turpis gravida nec Sed scelerisque nec turpis vel viverra. Vivamus vitae pretium sapien Code Blocks Code block with backticks 1 2 3 4 5 6 7 8 9 10 \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Code block indented with four spaces \u0026lt;!doctype html\u0026gt;\r\u0026lt;html lang=\u0026quot;en\u0026quot;\u0026gt;\r\u0026lt;head\u0026gt;\r\u0026lt;meta charset=\u0026quot;utf-8\u0026quot;\u0026gt;\r\u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt;\r\u0026lt;/head\u0026gt;\r\u0026lt;body\u0026gt;\r\u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt;\r\u0026lt;/body\u0026gt;\r\u0026lt;/html\u0026gt;\rDiff code block 1 2 3 4 5 [dependencies.bevy] git = \u0026#34;https://github.com/bevyengine/bevy\u0026#34; rev = \u0026#34;11f52b8c72fc3a568e8bb4a4cd1f3eb025ac2e13\u0026#34; - features = [\u0026#34;dynamic\u0026#34;] + features = [\u0026#34;jpeg\u0026#34;, \u0026#34;dynamic\u0026#34;] One line code block 1 \u0026lt;p\u0026gt;A paragraph\u0026lt;/p\u0026gt; List Types Ordered List First item Second item Third item Unordered List List item Another item And another item Nested list Fruit Apple Orange Banana Dairy Milk Cheese Other Elements â€” abbr, sub, sup, kbd, mark GIF is a bitmap image format.\nH2O\nXn + Yn = Zn\nPress CTRL + ALT + Delete to end the session.\nMost salamanders are nocturnal, and hunt for insects, worms, and other small creatures.\nThe above quote is excerpted from Rob Pike\u0026rsquo;s talk during Gopherfest, November 18, 2015.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n","date":"2023-09-07T00:00:00Z","permalink":"http://localhost:1313/p/markdown-syntax-guide/","title":"Markdown Syntax Guide"},{"content":"Hugo theme Stack supports the creation of interactive image galleries using Markdown. It\u0026rsquo;s powered by PhotoSwipe and its syntax was inspired by Typlog.\nTo use this feature, the image must be in the same directory as the Markdown file, as it uses Hugo\u0026rsquo;s page bundle feature to read the dimensions of the image. External images are not supported.\nSyntax 1 ![Image 1](1.jpg) ![Image 2](2.jpg) Result Photo by mymind and Luke Chesser on Unsplash\n","date":"2023-08-26T00:00:00Z","image":"http://localhost:1313/p/image-gallery/2_hubce42636ecacc1a380b462f3110efcec_37455_120x120_fill_q75_box_smart1.jpg","permalink":"http://localhost:1313/p/image-gallery/","title":"Image gallery"},{"content":"For more details, check out the documentation.\nBilibili video Tencent video YouTube video Generic video file Your browser doesn't support HTML5 video. Here is a link to the video instead. Gist GitLab Quote Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.\nâ€• A famous person, The book they wrote Photo by Codioful on Unsplash\n","date":"2023-08-25T00:00:00Z","image":"http://localhost:1313/p/shortcodes/cover_huec3c3e34981507583e214021ad1b9a4b_12942_120x120_fill_q75_box_smart1.jpg","permalink":"http://localhost:1313/p/shortcodes/","title":"Shortcodes"},{"content":"Stack has built-in support for math typesetting using KaTeX.\nIt\u0026rsquo;s not enabled by default side-wide, but you can enable it for individual posts by adding math: true to the front matter. Or you can enable it side-wide by adding math = true to the params.article section in config.toml.\nInline math This is an inline mathematical expression: $\\varphi = \\dfrac{1+\\sqrt5}{2}= 1.6180339887â€¦$\n1 $\\varphi = \\dfrac{1+\\sqrt5}{2}= 1.6180339887â€¦$ Block math $$ \\varphi = 1+\\frac{1} {1+\\frac{1} {1+\\frac{1} {1+\\cdots} } } $$\n1 2 3 $$ \\varphi = 1+\\frac{1} {1+\\frac{1} {1+\\frac{1} {1+\\cdots} } } $$ $$ f(x) = \\int_{-\\infty}^\\infty\\hat f(\\xi),e^{2 \\pi i \\xi x},d\\xi $$\n1 2 3 $$ f(x) = \\int_{-\\infty}^\\infty\\hat f(\\xi)\\,e^{2 \\pi i \\xi x}\\,d\\xi $$ ","date":"2023-08-24T00:00:00Z","permalink":"http://localhost:1313/p/math-typesetting/","title":"Math Typesetting"},{"content":"Welcome to Hugo theme Stack. This is your first post. Edit or delete it, then start writing!\nFor more information about this theme, check the documentation: https://stack.jimmycai.com/\nWant a site like this? Check out hugo-theme-stack-stater\nPhoto by Pawel Czerwinski on Unsplash\n","date":"2022-03-06T00:00:00Z","image":"http://localhost:1313/p/hello-world/cover_hud7e36f7e20e71be184458283bdae4646_55974_120x120_fill_q75_box_smart1.jpg","permalink":"http://localhost:1313/p/hello-world/","title":"Hello World"}]